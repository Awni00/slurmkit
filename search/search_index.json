{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"slurmkit","text":"<p>A CLI toolkit for managing and generating SLURM jobs.</p> <p>slurmkit provides tools for:</p> <ul> <li>Auto-discovering and tracking SLURM job status</li> <li>Generating job scripts from templates with parameter sweeps</li> <li>Organizing jobs into trackable collections</li> <li>Cross-cluster job synchronization</li> <li>Cleaning up failed jobs and W&amp;B runs</li> </ul>"},{"location":"#installation","title":"Installation","text":""},{"location":"#from-source","title":"From Source","text":"<pre><code>pip install git+https://github.com/Awni00/slurmkit.git\n</code></pre>"},{"location":"#dependencies","title":"Dependencies","text":"<p>Required:</p> <ul> <li>Python 3.8+</li> <li>PyYAML</li> <li>Jinja2</li> <li>pandas</li> <li>tabulate</li> </ul> <p>Optional:</p> <ul> <li>wandb (for W&amp;B cleanup features)</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#1-initialize-project","title":"1. Initialize Project","text":"<pre><code>cd your-project\nslurmkit init\n</code></pre> <p>This creates <code>.slurm-kit/config.yaml</code> with your settings.</p>"},{"location":"#2-check-job-status","title":"2. Check Job Status","text":"<pre><code>slurmkit status my_experiment\n</code></pre>"},{"location":"#3-generate-jobs-from-template","title":"3. Generate Jobs from Template","text":"<p>Create a template <code>templates/train.job.j2</code>:</p> <pre><code>#!/bin/bash\n#SBATCH --job-name={{ job_name }}\n#SBATCH --partition={{ slurm.partition }}\n#SBATCH --time={{ slurm.time }}\n#SBATCH --output={{ logs_dir }}/{{ job_name }}.%j.out\n\npython train.py --lr {{ learning_rate }} --bs {{ batch_size }}\n</code></pre> <p>Create a job spec <code>experiments/exp1/job_spec.yaml</code>:</p> <pre><code>name: exp1\ntemplate: ../../templates/train.job.j2\noutput_dir: job_scripts\nlogs_dir: logs\n\nparameters:\n  mode: grid\n  values:\n    learning_rate: [0.001, 0.01, 0.1]\n    batch_size: [32, 64]\n\nslurm_args:\n  defaults:\n    partition: gpu\n    time: \"24:00:00\"\n\njob_name_pattern: \"lr{{ learning_rate }}_bs{{ batch_size }}\"\n</code></pre> <p>Generate jobs:</p> <pre><code>slurmkit generate experiments/exp1/job_spec.yaml --collection exp1\n</code></pre>"},{"location":"#4-submit-jobs","title":"4. Submit Jobs","text":"<pre><code>slurmkit submit --collection exp1\n</code></pre>"},{"location":"#5-monitor-and-resubmit","title":"5. Monitor and Resubmit","text":"<pre><code># Update job states\nslurmkit collection update exp1\n\n# View collection status\nslurmkit collection show exp1\n\n# Resubmit failed jobs\nslurmkit resubmit --collection exp1 --filter failed\n</code></pre>"},{"location":"#commands","title":"Commands","text":"Command Description <code>slurmkit init</code> Initialize project configuration <code>slurmkit status &lt;exp&gt;</code> Show job status for experiment <code>slurmkit find &lt;job_id&gt;</code> Find output file for job ID <code>slurmkit generate &lt;spec&gt;</code> Generate job scripts from template <code>slurmkit submit</code> Submit job scripts <code>slurmkit resubmit</code> Resubmit failed jobs <code>slurmkit collection</code> Manage job collections <code>slurmkit clean outputs</code> Clean failed job outputs <code>slurmkit clean wandb</code> Clean failed W&amp;B runs <code>slurmkit sync</code> Sync job states for cross-cluster <p>Run <code>slurmkit &lt;command&gt; --help</code> for detailed usage.</p>"},{"location":"#configuration","title":"Configuration","text":"<p>Configuration is stored in <code>.slurm-kit/config.yaml</code>:</p> <pre><code>jobs_dir: jobs/\ncollections_dir: .job-collections/\n\noutput_patterns:\n  - \"{job_name}.{job_id}.out\"\n  - \"{job_name}.{job_id}.*.out\"\n\nslurm_defaults:\n  partition: gpu\n  time: \"24:00:00\"\n  mem: \"32G\"\n\njob_structure:\n  scripts_subdir: job_scripts/\n  logs_subdir: logs/\n</code></pre>"},{"location":"#environment-variables","title":"Environment Variables","text":"Variable Description <code>SLURMKIT_CONFIG</code> Path to config file <code>SLURMKIT_JOBS_DIR</code> Jobs directory <code>SLURMKIT_COLLECTIONS_DIR</code> Collections directory <code>SLURMKIT_WANDB_ENTITY</code> W&amp;B entity <code>SLURMKIT_DRY_RUN</code> Enable dry-run mode"},{"location":"#project-structure","title":"Project Structure","text":"<pre><code>your-project/\n\u251c\u2500\u2500 .slurm-kit/\n\u2502   \u251c\u2500\u2500 config.yaml          # Project configuration\n\u2502   \u2514\u2500\u2500 sync/                 # Cross-cluster sync files\n\u251c\u2500\u2500 .job-collections/         # Collection YAML files\n\u251c\u2500\u2500 jobs/\n\u2502   \u2514\u2500\u2500 experiment1/\n\u2502       \u251c\u2500\u2500 job_scripts/      # Generated job scripts\n\u2502       \u2514\u2500\u2500 logs/             # Job output files\n\u2514\u2500\u2500 templates/                # Jinja2 job templates\n</code></pre>"},{"location":"#features","title":"Features","text":""},{"location":"#job-collections","title":"Job Collections","text":"<p>Track related jobs together:</p> <pre><code># Create collection\nslurmkit collection create my_exp --description \"Training sweep\"\n\n# List collections\nslurmkit collection list\nslurmkit collection list --attempt-mode primary  # Optional override to primary submission states\n\n# Show details\nslurmkit collection show my_exp --state failed\n\n# Update states from SLURM\nslurmkit collection update my_exp\n</code></pre>"},{"location":"#parameter-sweeps","title":"Parameter Sweeps","text":"<p>Generate jobs from parameter grids:</p> <pre><code>parameters:\n  mode: grid\n  values:\n    learning_rate: [0.001, 0.01, 0.1]\n    batch_size: [32, 64, 128]\n    model: [resnet18, resnet50]\n</code></pre> <p>Or explicit lists:</p> <p><pre><code>parameters:\n  mode: list\n  values:\n    - {lr: 0.001, bs: 32}\n    - {lr: 0.01, bs: 64}\n\nFilter incompatible grid combinations with a Python predicate:\n\n```yaml\nparameters:\n  mode: grid\n  values:\n    algorithm: [algo_a, algo_b]\n    dataset: [small, large]\n  filter:\n    file: params_filter.py\n    function: include_params\n</code></pre> <pre><code>### Dynamic SLURM Arguments\n\nUse Python functions for complex resource logic:\n\n```python\n# slurm_logic.py\ndef get_slurm_args(params, defaults):\n    args = defaults.copy()\n    if params.get('model') == 'resnet50':\n        args['mem'] = '64G'\n        args['gpus'] = 2\n    return args\n</code></pre></p>"},{"location":"#cross-cluster-sync","title":"Cross-Cluster Sync","text":"<p>Share job status across clusters via git:</p> <pre><code># On cluster A\nslurmkit sync --push\n\n# On cluster B\ngit pull\nslurmkit collection show my_exp\n</code></pre>"},{"location":"#license","title":"License","text":"<p>MIT License - see LICENSE for details.</p>"},{"location":"cli-reference/","title":"CLI Reference","text":"<p>Complete reference for all slurmkit commands.</p>"},{"location":"cli-reference/#global-options","title":"Global Options","text":"<pre><code>slurmkit [--config PATH] [--ui MODE] [--version] &lt;command&gt;\n</code></pre> Option Description <code>--config PATH</code> Path to config file (default: <code>.slurm-kit/config.yaml</code>) <code>--ui MODE</code> UI override: <code>plain</code>, <code>rich</code>, <code>auto</code> (default from <code>ui.mode</code> config, fallback <code>plain</code>) <code>-V, --version</code> Show version and exit"},{"location":"cli-reference/#commands","title":"Commands","text":""},{"location":"cli-reference/#slurmkit-init","title":"slurmkit init","text":"<p>Initialize project configuration.</p> <pre><code>slurmkit init [--force]\n</code></pre> Option Description <code>--force</code> Overwrite existing configuration <p>Interactive prompts for: - Jobs directory - Default SLURM partition, time, memory - W&amp;B entity (optional) - Default UI mode (<code>plain</code>, <code>rich</code>, <code>auto</code>) - Notification route setup (optional)</p>"},{"location":"cli-reference/#slurmkit-status","title":"slurmkit status","text":"<p>Show job status for an experiment or all jobs.</p> <pre><code>slurmkit status [experiment] [options]\n</code></pre> Argument Description <code>experiment</code> Optional: Experiment subdirectory name. If not specified, shows all jobs. Option Description <code>--jobs-dir PATH</code> Override jobs directory <code>--collection NAME</code> Filter to jobs in collection <code>--state STATE</code> Filter by state: <code>all</code>, <code>running</code>, <code>pending</code>, <code>completed</code>, <code>failed</code> <code>--format FORMAT</code> Output format: <code>table</code>, <code>json</code>, <code>csv</code> <p>Examples:</p> <pre><code>slurmkit status                   # Show all jobs\nslurmkit status exp1              # Show jobs in exp1\nslurmkit status exp1 --state failed\nslurmkit status --format json\n</code></pre>"},{"location":"cli-reference/#slurmkit-find","title":"slurmkit find","text":"<p>Find job output file by job ID.</p> <pre><code>slurmkit find &lt;job_id&gt; [options]\n</code></pre> Argument Description <code>job_id</code> SLURM job ID Option Description <code>--jobs-dir PATH</code> Override jobs directory <code>--preview</code> Show preview of output file <code>--lines N</code> Lines to show in preview (default: 50) <code>--open</code> Open file in <code>$EDITOR</code> or pager <p>Examples:</p> <pre><code>slurmkit find 12345678\nslurmkit find 12345678 --preview --lines 100\nslurmkit find 12345678 --open\n</code></pre>"},{"location":"cli-reference/#slurmkit-clean-outputs","title":"slurmkit clean outputs","text":"<p>Clean failed job output files.</p> <pre><code>slurmkit clean outputs &lt;experiment&gt; [options]\n</code></pre> Argument Description <code>experiment</code> Experiment subdirectory name Option Description <code>--jobs-dir PATH</code> Override jobs directory <code>--threshold SECONDS</code> Max runtime to delete (default: 300) <code>--min-age DAYS</code> Min age to consider (default: 3) <code>--dry-run</code> Show what would be deleted <code>-y, --yes</code> Skip confirmation <p>Examples:</p> <pre><code>slurmkit clean outputs exp1\nslurmkit clean outputs exp1 --dry-run\nslurmkit clean outputs exp1 --threshold 600 --min-age 7 -y\n</code></pre>"},{"location":"cli-reference/#slurmkit-clean-wandb","title":"slurmkit clean wandb","text":"<p>Clean failed W&amp;B runs.</p> <pre><code>slurmkit clean wandb [options]\n</code></pre> Option Description <code>--projects PROJ...</code> W&amp;B projects to clean <code>--entity ENTITY</code> W&amp;B entity <code>--threshold SECONDS</code> Max runtime to delete (default: 300) <code>--min-age DAYS</code> Min age to consider (default: 3) <code>--dry-run</code> Show what would be deleted <code>-y, --yes</code> Skip confirmation <p>Examples:</p> <pre><code>slurmkit clean wandb --projects my-project\nslurmkit clean wandb --entity myteam --projects proj1 proj2 --dry-run\n</code></pre>"},{"location":"cli-reference/#slurmkit-generate","title":"slurmkit generate","text":"<p>Generate job scripts from template.</p> <pre><code>slurmkit generate &lt;spec_file&gt; [options]\nslurmkit generate --template FILE --params FILE [options]\n</code></pre> Argument Description <code>spec_file</code> Job spec YAML file Option Description <code>--template FILE</code> Template file (alternative to spec) <code>--params FILE</code> Parameters YAML file <code>--output-dir DIR</code> Output directory for scripts <code>--collection NAME</code> Add jobs to collection <code>--slurm-args-file FILE</code> Python file with SLURM args logic <code>--dry-run</code> Show preview without writing <p>Examples:</p> <pre><code>slurmkit generate job_spec.yaml\nslurmkit generate job_spec.yaml --collection my_exp\nslurmkit generate job_spec.yaml --dry-run\nslurmkit generate --template train.j2 --params params.yaml --output-dir scripts/\n</code></pre>"},{"location":"cli-reference/#slurmkit-submit","title":"slurmkit submit","text":"<p>Submit job scripts.</p> <pre><code>slurmkit submit [paths...] [options]\nslurmkit submit --collection NAME [options]\n</code></pre> Argument Description <code>paths</code> Job script(s) or directory Option Description <code>--collection NAME</code> Submit from or add to collection <code>--filter FILTER</code> For collection: <code>unsubmitted</code> or <code>all</code> <code>--delay SECONDS</code> Delay between submissions <code>--dry-run</code> Show what would be submitted <code>-y, --yes</code> Skip confirmation <p>Examples:</p> <pre><code>slurmkit submit jobs/exp1/scripts/\nslurmkit submit train_lr0.01.job train_lr0.1.job\nslurmkit submit --collection my_exp\nslurmkit submit --collection my_exp --filter all --delay 1\n</code></pre>"},{"location":"cli-reference/#slurmkit-resubmit","title":"slurmkit resubmit","text":"<p>Resubmit failed jobs.</p> <pre><code>slurmkit resubmit [job_ids...] [options]\nslurmkit resubmit --collection NAME [options]\n</code></pre> Argument Description <code>job_ids</code> Job ID(s) to resubmit Option Description <code>--collection NAME</code> Resubmit from collection <code>--filter FILTER</code> For collection: <code>failed</code> or <code>all</code> <code>--template FILE</code> Template override for regenerated resubmission scripts <code>--extra-params K=V,...</code> Extra parameters merged into regenerated template context <code>--extra-params-file FILE</code> Python file with <code>get_extra_params(context) -&gt; dict</code> <code>--extra-params-function NAME</code> Function name in <code>--extra-params-file</code> (default: <code>get_extra_params</code>) <code>--select-file FILE</code> Python file with <code>should_resubmit(context) -&gt; bool</code> <code>--select-function NAME</code> Function name in <code>--select-file</code> (default: <code>should_resubmit</code>) <code>--submission-group NAME</code> Submission group label (default: auto-generated <code>resubmit_YYYYMMDD_HHMMSS</code>) <code>--jobs-dir PATH</code> Override jobs directory <code>--regenerate</code> Force regeneration before resubmitting (requires <code>--collection</code>) <code>--no-regenerate</code> Reuse existing script path without regeneration <code>--dry-run</code> Show what would be resubmitted <code>-y, --yes</code> Skip confirmation <p><code>resubmit</code> defaults are mode-specific: - Collection mode (<code>--collection</code>): regenerate scripts by default. - Job ID mode (<code>slurmkit resubmit &lt;job_id...&gt;</code>): reuse existing scripts by default.</p> <p>Examples:</p> <pre><code>slurmkit resubmit 12345678\nslurmkit resubmit --collection my_exp --filter failed\nslurmkit resubmit --collection my_exp --extra-params \"checkpoint=last.pt\"\nslurmkit resubmit --collection my_exp --no-regenerate\nslurmkit resubmit --collection my_exp --submission-group retry_after_fix\nslurmkit resubmit --collection my_exp --select-file callbacks.py --select-function should_resubmit\n</code></pre>"},{"location":"cli-reference/#slurmkit-collection","title":"slurmkit collection","text":"<p>Manage job collections.</p>"},{"location":"cli-reference/#collection-create","title":"collection create","text":"<pre><code>slurmkit collection create &lt;name&gt; [--description TEXT]\n</code></pre>"},{"location":"cli-reference/#collection-list","title":"collection list","text":"<pre><code>slurmkit collection list [--attempt-mode MODE]\n</code></pre> Option Description <code>--attempt-mode MODE</code> <code>primary</code> or <code>latest</code> effective attempt (default: <code>latest</code>)"},{"location":"cli-reference/#collection-show","title":"collection show","text":"<pre><code>slurmkit collection show &lt;name&gt; [options]\n</code></pre> Option Description <code>--format FORMAT</code> Output: <code>table</code>, <code>json</code>, <code>yaml</code> <code>--state STATE</code> Filter: <code>all</code>, <code>pending</code>, <code>running</code>, <code>completed</code>, <code>failed</code> <code>--attempt-mode MODE</code> <code>primary</code> or <code>latest</code> effective attempt (default: <code>latest</code>) <code>--submission-group NAME</code> Restrict to jobs that have resubmissions in this group <code>--show-primary</code> Include primary job id/state columns in table output <code>--show-history</code> Include compact attempt history in table output"},{"location":"cli-reference/#collection-update","title":"collection update","text":"<pre><code>slurmkit collection update &lt;name&gt;\n</code></pre> <p>Refresh job states from SLURM.</p>"},{"location":"cli-reference/#collection-analyze","title":"collection analyze","text":"<pre><code>slurmkit collection analyze &lt;name&gt; [options]\n</code></pre> <p>Analyze how job states vary across parameter values.</p> Option Description <code>--format FORMAT</code> Output: <code>table</code>, <code>json</code> <code>--no-refresh</code> Skip SLURM refresh and analyze stored collection data <code>--min-support N</code> Minimum sample size for top risky/stable summaries (default: 3) <code>--param KEY</code> Analyze only selected parameter key(s); repeatable <code>--attempt-mode MODE</code> Use <code>primary</code> or <code>latest</code> attempt state (default: <code>primary</code>) <code>--submission-group NAME</code> Restrict to a submission group and analyze latest attempt within group <code>--top-k N</code> Number of rows in risky/stable summaries (default: 10)"},{"location":"cli-reference/#collection-groups","title":"collection groups","text":"<pre><code>slurmkit collection groups &lt;name&gt; [--format FORMAT]\n</code></pre> <p>List submission groups and job counts in a collection.</p> Option Description <code>--format FORMAT</code> Output: <code>table</code>, <code>json</code>, <code>yaml</code>"},{"location":"cli-reference/#collection-delete","title":"collection delete","text":"<pre><code>slurmkit collection delete &lt;name&gt; [--keep-scripts] [--keep-outputs] [-y]\n</code></pre> Option Description <code>--keep-scripts</code> Don't delete script files <code>--keep-outputs</code> Don't delete output files <code>-y, --yes</code> Skip confirmation"},{"location":"cli-reference/#collection-add","title":"collection add","text":"<pre><code>slurmkit collection add &lt;name&gt; &lt;job_id&gt; [job_id...]\n</code></pre>"},{"location":"cli-reference/#collection-remove","title":"collection remove","text":"<pre><code>slurmkit collection remove &lt;name&gt; &lt;job_id&gt; [job_id...]\n</code></pre> <p>Examples:</p> <pre><code>slurmkit collection create my_exp --description \"Training sweep\"\nslurmkit collection list\nslurmkit collection show my_exp --state failed\nslurmkit collection show my_exp --attempt-mode latest --show-primary --show-history\nslurmkit collection show my_exp --submission-group retry_after_fix\nslurmkit collection update my_exp\nslurmkit collection analyze my_exp --min-support 5 --param algo --param learning_rate\nslurmkit collection analyze my_exp --attempt-mode latest --format json\nslurmkit collection analyze my_exp --submission-group retry_after_fix\nslurmkit collection groups my_exp\nslurmkit --ui rich collection show my_exp\nslurmkit --ui auto collection analyze my_exp\nslurmkit collection delete my_exp --keep-outputs\nslurmkit collection add my_exp 12345678 12345679\n</code></pre>"},{"location":"cli-reference/#slurmkit-sync","title":"slurmkit sync","text":"<p>Sync job states for cross-cluster tracking.</p> <pre><code>slurmkit sync [options]\n</code></pre> Option Description <code>--collection NAME...</code> Sync specific collections <code>--output FILE</code> Output file path <code>--push</code> Git commit and push sync file <p>Examples:</p> <pre><code>slurmkit sync\nslurmkit sync --collection exp1 exp2\nslurmkit sync --push\n</code></pre>"},{"location":"cli-reference/#slurmkit-notify","title":"slurmkit notify","text":"<p>Send job and collection lifecycle notifications to configured routes (<code>webhook</code>, <code>slack</code>, <code>discord</code>, <code>email</code>).</p>"},{"location":"cli-reference/#notify-job","title":"notify job","text":"<pre><code>slurmkit notify job [options]\n</code></pre> Option Description <code>--job-id JOB_ID</code> SLURM job ID (defaults to <code>SLURM_JOB_ID</code>) <code>--collection NAME</code> Optional collection to narrow metadata lookup <code>--exit-code N</code> Exit code used to derive event (<code>0</code> =&gt; completed, nonzero =&gt; failed) <code>--on MODE</code> <code>failed</code> (default) or <code>always</code> <code>--route NAME</code> Route name filter (repeatable) <code>--tail-lines N</code> Override failure output tail line count <code>--strict</code> Require all attempted routes to succeed <code>--dry-run</code> Preview payload/routes without sending deliveries <p>Examples:</p> <pre><code>slurmkit notify job --job-id 12345 --exit-code 1\nslurmkit notify job --job-id 12345 --exit-code 0 --on always\nslurmkit notify job --job-id 12345 --route team_slack --route custom_ops\nslurmkit notify job --job-id 12345 --dry-run\n</code></pre>"},{"location":"cli-reference/#notify-test","title":"notify test","text":"<pre><code>slurmkit notify test [options]\n</code></pre> Option Description <code>--route NAME</code> Route name filter (repeatable) <code>--strict</code> Require all attempted routes to succeed <code>--dry-run</code> Preview payload/routes without sending deliveries <p>Examples:</p> <pre><code>slurmkit notify test\nslurmkit notify test --route team_slack\nslurmkit notify test --dry-run\nslurmkit notify test --route team_email --dry-run\n</code></pre>"},{"location":"cli-reference/#notify-collection-final","title":"notify collection-final","text":"<pre><code>slurmkit notify collection-final [options]\n</code></pre> Option Description <code>--job-id JOB_ID</code> Triggering SLURM job ID (defaults to <code>SLURM_JOB_ID</code>) <code>--trigger-exit-code EXIT_CODE</code> Optional trigger exit code for trigger-aware terminal inference (<code>0</code> completed, non-zero failed) <code>--collection NAME</code> Optional collection name (otherwise resolved by job ID) <code>--route NAME</code> Route name filter (repeatable) <code>--strict</code> Require all attempted routes to succeed <code>--dry-run</code> Preview payload/routes without sending deliveries <code>--force</code> Bypass deduplication for repeated terminal snapshots <code>--no-refresh</code> Skip SLURM refresh before finality check <p>Examples:</p> <pre><code>slurmkit notify collection-final --job-id 12345\nslurmkit notify collection-final --job-id 12345 --collection my_exp\nslurmkit notify collection-final --job-id 12345 --trigger-exit-code 1\nslurmkit notify collection-final --job-id 12345 --route team_slack --strict\nslurmkit notify collection-final --job-id 12345 --no-refresh --dry-run\n</code></pre>"},{"location":"cli-reference/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 General error 2 File not found / ambiguous match 130 Interrupted (Ctrl+C)"},{"location":"collections/","title":"Job Collections","text":"<p>Collections are groups of related jobs that are generated and submitted together. They provide:</p> <ul> <li>Tracking - Monitor job states across submissions</li> <li>Organization - Group related experiments</li> <li>Resubmission - Easily retry failed jobs</li> <li>Cross-cluster sync - Share status across clusters</li> </ul>"},{"location":"collections/#collection-structure","title":"Collection Structure","text":"<p>Collections are stored as YAML files in <code>.job-collections/</code> (configurable):</p> <pre><code>name: my_experiment\ndescription: \"Hyperparameter sweep for model training\"\ncreated_at: \"2025-01-15T10:30:00\"\nupdated_at: \"2025-01-15T14:00:00\"\ncluster: cluster-a\n\n# Generation parameters (for reference)\nparameters:\n  mode: grid\n  values:\n    learning_rate: [0.001, 0.01, 0.1]\n    batch_size: [32, 64]\n\n# Generation context for deterministic resubmission regeneration\nmeta:\n  generation:\n    template_path: templates/train.job.j2\n    output_dir: jobs/exp1/job_scripts\n    job_name_pattern: \"resnet18_lr{{ learning_rate }}_bs{{ batch_size }}\"\n    logs_dir: jobs/exp1/logs\n    slurm_defaults:\n      partition: gpu\n      time: \"12:00:00\"\n    slurm_logic_file: experiments/exp1/slurm_logic.py\n    slurm_logic_function: get_slurm_args\n\n# List of jobs\njobs:\n  - job_name: resnet18_lr0.001_bs32\n    job_id: \"12345678\"\n    script_path: jobs/exp1/job_scripts/resnet18_lr0.001_bs32.job\n    output_path: jobs/exp1/logs/resnet18_lr0.001_bs32.12345678.out\n    state: COMPLETED\n    hostname: cluster-a\n    parameters:\n      learning_rate: 0.001\n      batch_size: 32\n    submitted_at: \"2025-01-15T10:35:00\"\n    started_at: \"2025-01-15T10:40:00\"\n    completed_at: \"2025-01-15T14:20:00\"\n    resubmissions: []\n\n  - job_name: resnet18_lr0.01_bs64\n    job_id: \"12345679\"\n    state: FAILED\n    hostname: cluster-a\n    # ... other fields ...\n    resubmissions:\n      - job_id: \"12345700\"\n        state: RUNNING\n        hostname: cluster-a\n        submitted_at: \"2025-01-15T15:00:00\"\n        regenerated: true\n        job_name: resnet18_lr0.01_bs64.resubmit-1\n        script_path: jobs/exp1/job_scripts/resnet18_lr0.01_bs64.resubmit-1.job\n        parameters:\n          learning_rate: 0.01\n          batch_size: 64\n          checkpoint: checkpoints/epoch_10.pt\n        extra_params:\n          checkpoint: checkpoints/epoch_10.pt\n</code></pre>"},{"location":"collections/#cli-commands","title":"CLI Commands","text":""},{"location":"collections/#create-collection","title":"Create Collection","text":"<pre><code>slurmkit collection create my_experiment --description \"Training sweep\"\n</code></pre>"},{"location":"collections/#list-collections","title":"List Collections","text":"<pre><code>slurmkit collection list\n# Optional override to use primary submission state counts\nslurmkit collection list --attempt-mode primary\n</code></pre> <p><code>collection list</code> uses latest-attempt status counts by default.</p> <p>Output: <pre><code>Found 3 collection(s):\n\nName           Description                 Total  Completed  Failed  Pending  Running\nmy_experiment  Training sweep              12     8          2       0        2\nexp2           Architecture comparison     6      6          0       0        0\ndefault        (auto-created)              4      1          3       0        0\n</code></pre></p>"},{"location":"collections/#show-collection-details","title":"Show Collection Details","text":"<pre><code>slurmkit collection show my_experiment\n</code></pre> <p>Options: - <code>--format json</code> - Output as JSON - <code>--format yaml</code> - Output as YAML - <code>--state failed</code> - Filter by effective state - <code>--attempt-mode latest</code> - Effective attempt semantics (<code>latest</code> is default) - <code>--submission-group retry_after_fix</code> - Restrict to jobs in a submission group - <code>--show-primary</code> - Include primary submission state/id columns - <code>--show-history</code> - Include compact attempt history in table mode</p>"},{"location":"collections/#update-job-states","title":"Update Job States","text":"<p>Refresh job states from SLURM:</p> <pre><code>slurmkit collection update my_experiment\n</code></pre>"},{"location":"collections/#analyze-status-by-parameter","title":"Analyze Status by Parameter","text":"<p>Find patterns between parameter values and job outcomes:</p> <pre><code>slurmkit collection analyze my_experiment\n</code></pre> <p>Options: - <code>--format json</code> - Output analysis as JSON - <code>--no-refresh</code> - Skip SLURM refresh (analyze current YAML state) - <code>--min-support N</code> - Minimum sample size for risky/stable summaries (default: 3) - <code>--param KEY</code> - Restrict analysis to specific parameter keys (repeatable) - <code>--attempt-mode latest</code> - Use latest resubmission state instead of primary job state - <code>--submission-group NAME</code> - Analyze latest attempt within a specific submission group - <code>--top-k N</code> - Number of entries in top risky/stable lists (default: 10)</p> <p>Examples:</p> <pre><code># Analyze specific parameters\nslurmkit collection analyze my_experiment --param algo --param learning_rate\n\n# Use latest retry outcome and stricter support threshold\nslurmkit collection analyze my_experiment --attempt-mode latest --min-support 5\n\n# Analyze a specific resubmission group\nslurmkit collection analyze my_experiment --submission-group retry_after_fix\n\n# Machine-readable output\nslurmkit collection analyze my_experiment --format json\n</code></pre> <p>The report includes: - Overall normalized state summary (<code>completed</code>, <code>failed</code>, <code>running</code>, <code>pending</code>, <code>unknown</code>) - Per-parameter value tables with counts and failure/completion rates - Top risky values (highest failure rates) - Top stable values (highest completion rates) - <code>Low N</code> marker for groups below <code>--min-support</code></p>"},{"location":"collections/#delete-collection","title":"Delete Collection","text":"<pre><code>slurmkit collection delete my_experiment\n</code></pre> <p>Options: - <code>--keep-scripts</code> - Don't delete job script files - <code>--keep-outputs</code> - Don't delete output files - <code>-y</code> - Skip confirmation</p>"},{"location":"collections/#add-jobs-to-collection","title":"Add Jobs to Collection","text":"<p>Add existing jobs by ID:</p> <pre><code>slurmkit collection add my_experiment 12345678 12345679\n</code></pre>"},{"location":"collections/#remove-jobs-from-collection","title":"Remove Jobs from Collection","text":"<pre><code>slurmkit collection remove my_experiment 12345678\n</code></pre>"},{"location":"collections/#list-submission-groups","title":"List Submission Groups","text":"<pre><code>slurmkit collection groups my_experiment\n</code></pre> <p>This reports: - <code>submission_group</code> - <code>slurm_job_count</code> - <code>parent_job_count</code> - <code>first_submitted_at</code> - <code>last_submitted_at</code></p> <p>Historical resubmissions without explicit group labels are reported as <code>legacy_ungrouped</code>.</p>"},{"location":"collections/#default-collection","title":"Default Collection","text":"<p>When generating or submitting jobs without specifying a collection, slurmkit uses the <code>default</code> collection:</p> <pre><code># Uses \"default\" collection\nslurmkit generate job_spec.yaml\n# Note: No collection specified. Using 'default' collection.\n</code></pre> <p>To use a specific collection:</p> <pre><code>slurmkit generate job_spec.yaml --collection my_experiment\n</code></pre>"},{"location":"collections/#collection-workflow","title":"Collection Workflow","text":""},{"location":"collections/#1-generate-jobs","title":"1. Generate Jobs","text":"<p>Jobs are automatically added to collection during generation:</p> <pre><code>slurmkit generate job_spec.yaml --collection my_experiment\n</code></pre>"},{"location":"collections/#2-submit-jobs","title":"2. Submit Jobs","text":"<p>Submit all unsubmitted jobs:</p> <pre><code>slurmkit submit --collection my_experiment\n</code></pre> <p>Submit all jobs (including already submitted):</p> <pre><code>slurmkit submit --collection my_experiment --filter all\n</code></pre>"},{"location":"collections/#3-monitor-status","title":"3. Monitor Status","text":"<p>Check collection status:</p> <pre><code>slurmkit collection show my_experiment\n</code></pre> <p>Update states from SLURM:</p> <pre><code>slurmkit collection update my_experiment\n</code></pre>"},{"location":"collections/#4-resubmit-failed-jobs","title":"4. Resubmit Failed Jobs","text":"<pre><code>slurmkit resubmit --collection my_experiment --filter failed\n</code></pre> <p>Collection mode regenerates scripts by default. Use <code>--no-regenerate</code> to reuse the existing <code>.job</code> file directly.</p> <p>With extra parameters (e.g., resume from checkpoint):</p> <pre><code>slurmkit resubmit --collection my_experiment --filter failed \\\n    --extra-params \"checkpoint=checkpoints/last.pt\"\n</code></pre> <p>Each resubmit invocation records a <code>submission_group</code>. - Explicit: <code>--submission-group retry_after_fix</code> - Default: auto-generated <code>resubmit_YYYYMMDD_HHMMSS</code></p> <p>You can also use Python callbacks:</p> <pre><code>slurmkit resubmit --collection my_experiment \\\n  --select-file callbacks.py \\\n  --select-function should_resubmit \\\n  --extra-params-file callbacks.py \\\n  --extra-params-function get_extra_params\n</code></pre>"},{"location":"collections/#notifications-integration","title":"Notifications Integration","text":"<p>Collections are used by <code>slurmkit notify job</code> to enrich notifications with: - Collection name/description - Job metadata (name, state, timestamps) - Output path and failure tail snippet (when available)</p> <p>Collections also drive terminal collection reporting via <code>slurmkit notify collection-final</code>: - evaluates finality with latest-attempt semantics - sends <code>collection_completed</code> or <code>collection_failed</code> when terminal - supports trigger-aware terminal inference via <code>--trigger-exit-code</code> - deduplicates repeated terminal snapshots via collection metadata</p> <p>Typical end-of-job pattern:</p> <pre><code>rc=$?\nslurmkit notify job --job-id \"${SLURM_JOB_ID}\" --exit-code \"${rc}\"\nslurmkit notify collection-final --job-id \"${SLURM_JOB_ID}\" --trigger-exit-code \"${rc}\"\nexit \"${rc}\"\n</code></pre> <p>See Notifications for full route setup and command reference.</p>"},{"location":"collections/#cross-cluster-tracking","title":"Cross-Cluster Tracking","text":"<p>Jobs track the hostname where they were submitted:</p> <pre><code>jobs:\n  - job_name: train_model\n    job_id: \"12345\"\n    hostname: cluster-a\n    # ...\n</code></pre> <p>This allows tracking the same experiment across multiple clusters. See Cross-Cluster Sync for details.</p>"},{"location":"collections/#resubmission-tracking","title":"Resubmission Tracking","text":"<p>When jobs are resubmitted, the history is preserved:</p> <pre><code>jobs:\n  - job_name: train_model\n    job_id: \"12345\"  # Original submission\n    state: FAILED\n    resubmissions:\n      - job_id: \"12346\"  # First retry\n        state: FAILED\n        submitted_at: \"2025-01-15T14:00:00\"\n        regenerated: true\n        job_name: train_model.resubmit-1\n        script_path: jobs/exp1/job_scripts/train_model.resubmit-1.job\n        parameters:\n          checkpoint: checkpoints/epoch_10.pt\n      - job_id: \"12347\"  # Second retry\n        state: COMPLETED\n        submitted_at: \"2025-01-15T15:00:00\"\n        regenerated: false\n        extra_params:\n          checkpoint: checkpoints/epoch_50.pt\n</code></pre>"},{"location":"collections/#programmatic-usage","title":"Programmatic Usage","text":"<pre><code>from slurmkit.collections import Collection, CollectionManager\n\n# Create manager\nmanager = CollectionManager()\n\n# Create collection\ncollection = manager.create(\n    \"my_experiment\",\n    description=\"Training sweep\",\n)\n\n# Add jobs\ncollection.add_job(\n    job_name=\"train_lr0.01\",\n    script_path=\"jobs/exp1/train_lr0.01.job\",\n    parameters={\"learning_rate\": 0.01},\n)\n\n# Save\nmanager.save(collection)\n\n# Load existing\ncollection = manager.load(\"my_experiment\")\n\n# Update states from SLURM\nupdated_count = collection.refresh_states()\n\n# Get summary\nsummary = collection.get_summary()\nprint(f\"Completed: {summary['completed']}/{summary['total']}\")\n\n# Filter jobs\nfailed_jobs = collection.filter_jobs(state=\"failed\")\npending_jobs = collection.filter_jobs(submitted=False)\n\n# Record resubmission\ncollection.add_resubmission(\n    \"train_lr0.01\",\n    job_id=\"12346\",\n    extra_params={\"checkpoint\": \"checkpoints/last.pt\"},\n)\n\nmanager.save(collection)\n</code></pre>"},{"location":"collections/#best-practices","title":"Best Practices","text":"<ol> <li>Use descriptive names - Collection names should identify the experiment</li> <li>Add descriptions - Help future you understand what the collection is for</li> <li>Update regularly - Run <code>collection update</code> to keep states current</li> <li>Track parameters - Include generation parameters for reproducibility</li> <li>Use for related jobs - Don't mix unrelated experiments in one collection</li> </ol>"},{"location":"configuration/","title":"Configuration","text":"<p>slurmkit uses a layered configuration system with the following precedence (highest to lowest):</p> <ol> <li>CLI arguments - Override everything</li> <li>Environment variables - System-level defaults</li> <li>Project config file - <code>.slurm-kit/config.yaml</code></li> <li>Built-in defaults - Fallback values</li> </ol>"},{"location":"configuration/#configuration-file","title":"Configuration File","text":"<p>The project configuration file is located at <code>.slurm-kit/config.yaml</code> relative to your project root.</p>"},{"location":"configuration/#creating-configuration","title":"Creating Configuration","text":"<p>Initialize configuration interactively:</p> <pre><code>slurmkit init\n</code></pre> <p>Or create/edit <code>.slurm-kit/config.yaml</code> manually.</p>"},{"location":"configuration/#full-configuration-reference","title":"Full Configuration Reference","text":"<pre><code># =============================================================================\n# Directory Structure\n# =============================================================================\n\n# Root directory for job files (scripts, outputs)\n# Relative paths are resolved from project root\njobs_dir: jobs/\n\n# Directory for collection YAML files\ncollections_dir: .job-collections/\n\n# Directory for cross-cluster sync files\nsync_dir: .slurm-kit/sync/\n\n# =============================================================================\n# Output File Patterns\n# =============================================================================\n\n# Patterns to match job output files\n# Tried in order; first match wins\n# Placeholders: {job_name}, {job_id}\noutput_patterns:\n  - \"{job_name}.{job_id}.out\"\n  - \"{job_name}.{job_id}.*.out\"\n  - \"slurm-{job_id}.out\"\n\n# =============================================================================\n# Job Directory Structure\n# =============================================================================\n\n# Subdirectory names within each experiment directory\njob_structure:\n  scripts_subdir: job_scripts/   # Where job scripts are stored\n  logs_subdir: logs/             # Where output files are stored\n\n# =============================================================================\n# Default SLURM Arguments\n# =============================================================================\n\n# These defaults are used when generating jobs\nslurm_defaults:\n  partition: compute\n  time: \"24:00:00\"\n  mem: \"16G\"\n  nodes: 1\n  ntasks: 1\n  # Add any other SLURM directives here\n  # gpus: 1\n  # cpus-per-task: 4\n\n# =============================================================================\n# Cleanup Settings\n# =============================================================================\n\ncleanup:\n  # Minimum runtime (seconds) for jobs to keep during cleanup\n  # Jobs that failed faster than this are candidates for deletion\n  threshold_seconds: 300\n\n  # Minimum age (days) for jobs to consider during cleanup\n  # Prevents deleting recent failures that might be retrying\n  min_age_days: 3\n\n# =============================================================================\n# CLI UI Settings\n# =============================================================================\n\nui:\n  # plain: always plain tables\n  # rich: require Rich rendering\n  # auto: use Rich on interactive terminals when available, else plain\n  mode: plain\n\n# =============================================================================\n# Notifications (Optional)\n# =============================================================================\n\nnotifications:\n  defaults:\n    # Applied when route-level settings are not provided\n    events: [job_failed]\n    timeout_seconds: 5\n    max_attempts: 3\n    backoff_seconds: 0.5\n    output_tail_lines: 40\n\n  job:\n    ai:\n      enabled: false\n      callback: null  # \"module.path:function_name\"\n\n  collection_final:\n    attempt_mode: latest\n    min_support: 3\n    top_k: 10\n    include_failed_output_tail_lines: 20\n    ai:\n      enabled: false\n      callback: null  # \"module.path:function_name\"\n\n  routes:\n    - name: team_slack\n      type: slack            # slack | discord | webhook | email\n      url: \"${SLACK_WEBHOOK_URL}\"\n      enabled: true\n      events: [job_failed, collection_failed]\n      headers: {}\n      timeout_seconds: 5\n      max_attempts: 3\n      backoff_seconds: 0.5\n\n    - name: team_email\n      type: email\n      to: [\"ops@example.com\", \"ml@example.com\"]\n      from: \"${SLURMKIT_EMAIL_FROM}\"\n      smtp_host: \"${SMTP_HOST}\"\n      smtp_port: 587\n      smtp_username: \"${SMTP_USER}\"\n      smtp_password: \"${SMTP_PASSWORD}\"\n      smtp_starttls: true\n      smtp_ssl: false\n      events: [job_failed, collection_failed]\n\n# =============================================================================\n# W&amp;B Settings (Optional)\n# =============================================================================\n\nwandb:\n  # Your W&amp;B username or team name\n  entity: null\n\n  # Default projects for cleanup commands\n  default_projects: []\n</code></pre>"},{"location":"configuration/#environment-variables","title":"Environment Variables","text":"<p>All settings can be overridden via environment variables:</p> Variable Description Example <code>SLURMKIT_CONFIG</code> Path to config file <code>/path/to/config.yaml</code> <code>SLURMKIT_JOBS_DIR</code> Jobs directory <code>experiments/</code> <code>SLURMKIT_COLLECTIONS_DIR</code> Collections directory <code>.collections/</code> <code>SLURMKIT_SYNC_DIR</code> Sync files directory <code>.slurm-kit/sync/</code> <code>SLURMKIT_WANDB_ENTITY</code> W&amp;B entity <code>awni00</code> <code>SLURMKIT_WANDB_PROJECT</code> Default W&amp;B project <code>my-project</code> <code>SLURMKIT_DRY_RUN</code> Global dry-run mode <code>1</code> or <code>true</code>"},{"location":"configuration/#example-usage","title":"Example Usage","text":"<pre><code># Use different jobs directory\nexport SLURMKIT_JOBS_DIR=experiments/\n\n# Enable dry-run mode globally\nexport SLURMKIT_DRY_RUN=1\n\n# Run command with overrides\nslurmkit status exp1\n</code></pre>"},{"location":"configuration/#cli-overrides","title":"CLI Overrides","text":"<p>Most commands accept arguments to override configuration:</p> <pre><code># Override jobs directory\nslurmkit status exp1 --jobs-dir /custom/path/\n\n# Override config file\nslurmkit --config /path/to/config.yaml status exp1\n\n# Override UI mode for one command\nslurmkit --ui rich collection analyze exp1\n</code></pre>"},{"location":"configuration/#ui-mode-resolution","title":"UI Mode Resolution","text":"<p>UI mode is resolved in this order:</p> <ol> <li>CLI override: <code>--ui {plain,rich,auto}</code></li> <li>Config value: <code>ui.mode</code></li> <li>Fallback: <code>plain</code></li> </ol> <p>If <code>--ui rich</code> is requested but Rich is not installed, slurmkit exits with an install hint:</p> <pre><code>pip install slurmkit[ui]\n</code></pre>"},{"location":"configuration/#output-file-patterns","title":"Output File Patterns","text":"<p>The <code>output_patterns</code> setting controls how slurmkit finds and parses job output files.</p>"},{"location":"configuration/#pattern-syntax","title":"Pattern Syntax","text":"<ul> <li><code>{job_name}</code> - Matches the job name (any characters)</li> <li><code>{job_id}</code> - Matches the SLURM job ID (digits, optional underscore for arrays)</li> <li><code>*</code> - Wildcard (any characters except dots)</li> </ul>"},{"location":"configuration/#common-patterns","title":"Common Patterns","text":"<pre><code>output_patterns:\n  # Standard pattern: job_name.job_id.out\n  - \"{job_name}.{job_id}.out\"\n\n  # With extra suffix: job_name.job_id.hostname.out\n  - \"{job_name}.{job_id}.*.out\"\n\n  # SLURM default: slurm-job_id.out\n  - \"slurm-{job_id}.out\"\n\n  # Array jobs: job_name.job_id_index.out\n  - \"{job_name}.{job_id}.out\"\n</code></pre>"},{"location":"configuration/#priority","title":"Priority","text":"<p>Patterns are tried in order. Use more specific patterns first:</p> <pre><code>output_patterns:\n  # More specific first\n  - \"{job_name}.{job_id}.node01.out\"\n  - \"{job_name}.{job_id}.*.out\"\n  # Generic fallback last\n  - \"slurm-{job_id}.out\"\n</code></pre>"},{"location":"configuration/#slurm-defaults","title":"SLURM Defaults","text":"<p>The <code>slurm_defaults</code> section provides default values for job generation:</p> <pre><code>slurm_defaults:\n  partition: gpu\n  time: \"48:00:00\"\n  mem: \"64G\"\n  nodes: 1\n  ntasks: 1\n  gpus: 2\n  cpus-per-task: 8\n\n  # Any valid SLURM directive\n  mail-user: user@example.com\n  mail-type: END,FAIL\n</code></pre> <p>These are passed to job templates as <code>{{ slurm.partition }}</code>, <code>{{ slurm.time }}</code>, etc.</p>"},{"location":"configuration/#notifications","title":"Notifications","text":"<p>Use <code>notifications.routes</code> to define where <code>slurmkit notify</code> sends events.</p>"},{"location":"configuration/#route-fields","title":"Route Fields","text":"<ul> <li><code>name</code> - Unique route name used by <code>slurmkit notify --route ...</code></li> <li><code>type</code> - <code>webhook</code>, <code>slack</code>, <code>discord</code>, or <code>email</code></li> <li><code>url</code> - Destination URL for <code>webhook</code>/<code>slack</code>/<code>discord</code>; supports <code>${ENV_VAR}</code> interpolation</li> <li><code>enabled</code> - Optional boolean (default: <code>true</code>)</li> <li><code>events</code> - Optional list of subscribed events</li> <li><code>headers</code> - Optional HTTP headers map for <code>webhook</code>; supports <code>${ENV_VAR}</code> interpolation</li> <li><code>timeout_seconds</code> - Optional request timeout override</li> <li><code>max_attempts</code> - Optional retry attempts override</li> <li><code>backoff_seconds</code> - Optional retry backoff override</li> </ul> <p>Email-specific route fields: - <code>to</code> - Required recipient list (string, comma-separated string, or list) - <code>from</code> - Required sender address - <code>smtp_host</code> - Required SMTP host - <code>smtp_port</code> - Optional SMTP port (default: <code>587</code>) - <code>smtp_username</code> / <code>smtp_password</code> - Optional auth pair (must be set together) - <code>smtp_starttls</code> - Optional boolean (default: <code>true</code>) - <code>smtp_ssl</code> - Optional boolean (default: <code>false</code>)</p> <p>Supported events: - <code>job_failed</code> - <code>job_completed</code> - <code>collection_failed</code> - <code>collection_completed</code></p>"},{"location":"configuration/#defaults-behavior","title":"Defaults Behavior","text":"<ul> <li>If <code>events</code> is omitted on a route, it defaults to <code>notifications.defaults.events</code>.</li> <li>If <code>notifications.defaults.events</code> is omitted, it defaults to <code>[job_failed]</code>.</li> <li>Retry and timeout values fall back from route settings to <code>notifications.defaults</code>.</li> </ul>"},{"location":"configuration/#job-notification-ai-settings","title":"Job Notification AI Settings","text":"<p><code>notifications.job.ai</code> controls optional callback enrichment for <code>slurmkit notify job</code>: - <code>enabled</code> - Enable optional Python callback enrichment - <code>callback</code> - Callback in <code>module.path:function_name</code> format</p> <p>When job AI callback execution fails, deterministic notification delivery still proceeds and payload marks <code>ai_status: unavailable</code>.</p>"},{"location":"configuration/#collection-final-report-settings","title":"Collection Final Report Settings","text":"<p><code>notifications.collection_final</code> controls <code>slurmkit notify collection-final</code> behavior: - <code>attempt_mode</code> - <code>latest</code> (default) or <code>primary</code> - <code>min_support</code> - Support threshold for risky/stable analysis tables - <code>top_k</code> - Number of top risky/stable values included in report - <code>include_failed_output_tail_lines</code> - Tail lines embedded per failed job - <code>ai.enabled</code> - Enable optional Python callback enrichment - <code>ai.callback</code> - Callback in <code>module.path:function_name</code> format</p> <p>When AI callback execution fails, deterministic report delivery still proceeds and payload marks <code>ai_status: unavailable</code>.</p>"},{"location":"configuration/#collection-spec-notification-overrides","title":"Collection Spec Notification Overrides","text":"<p>Collections generated from <code>job_spec.yaml</code> persist <code>meta.generation.spec_path</code>. At notify-time, slurmkit loads that spec and checks for a top-level <code>notifications</code> block.</p> <p>Precedence: - <code>spec.yaml</code> top-level <code>notifications</code> (collection-specific override) - <code>.slurm-kit/config.yaml</code> <code>notifications</code> (global fallback)</p> <p>Merge behavior: - Mapping values deep-merge recursively. - List values replace global values (including <code>notifications.routes</code>).</p> <p>Fallback behavior: - If the spec file is missing/unreadable/malformed, slurmkit emits a context warning and falls back to global notifications. - If the spec has no top-level <code>notifications</code> key, global notifications are used without warning.</p>"},{"location":"configuration/#environment-variable-interpolation","title":"Environment Variable Interpolation","text":"<p>Webhook fields support <code>${VAR_NAME}</code> placeholders:</p> <pre><code>notifications:\n  routes:\n    - name: secure_webhook\n      type: webhook\n      url: \"${NOTIFY_WEBHOOK_URL}\"\n      headers:\n        Authorization: \"Bearer ${NOTIFY_WEBHOOK_TOKEN}\"\n</code></pre> <p>Email SMTP fields support the same interpolation:</p> <pre><code>notifications:\n  routes:\n    - name: mail_alerts\n      type: email\n      to: \"${EMAIL_RECIPIENTS}\"\n      from: \"${EMAIL_FROM}\"\n      smtp_host: \"${SMTP_HOST}\"\n      smtp_username: \"${SMTP_USER}\"\n      smtp_password: \"${SMTP_PASSWORD}\"\n</code></pre> <p>If any referenced variable is missing, that route is treated as a route-level configuration error at runtime.</p>"},{"location":"configuration/#programmatic-access","title":"Programmatic Access","text":"<p>Access configuration from Python:</p> <pre><code>from slurmkit import get_config\n\n# Get global config\nconfig = get_config()\n\n# Access values\njobs_dir = config.get_path(\"jobs_dir\")\npartition = config.get(\"slurm_defaults.partition\")\npatterns = config.get_output_patterns()\n\n# Get full config as dict\nconfig_dict = config.as_dict()\n</code></pre>"},{"location":"getting-started/","title":"Getting Started with slurmkit","text":"<p>This guide will help you get started with slurmkit for managing SLURM jobs.</p>"},{"location":"getting-started/#installation","title":"Installation","text":""},{"location":"getting-started/#from-source-development","title":"From Source (Development)","text":"<pre><code># Clone the repository\ngit clone https://github.com/Awni00/slurm-job-utils.git\ncd slurm-job-utils\n\n# Install in development mode\npip install -e .\n# Optional Rich UI support\npip install -e \".[ui]\"\n</code></pre>"},{"location":"getting-started/#from-pypi-when-published","title":"From PyPI (When Published)","text":"<pre><code>pip install slurmkit\n</code></pre>"},{"location":"getting-started/#initial-setup","title":"Initial Setup","text":""},{"location":"getting-started/#initialize-project-configuration","title":"Initialize Project Configuration","text":"<p>Navigate to your project directory and run:</p> <pre><code>slurmkit init\n</code></pre> <p>This interactive wizard will create <code>.slurm-kit/config.yaml</code> with your settings:</p> <ul> <li>Jobs directory path</li> <li>Default SLURM arguments (partition, time, memory)</li> <li>W&amp;B entity (optional)</li> <li>Default CLI UI mode (<code>plain</code>, <code>rich</code>, <code>auto</code>)</li> </ul>"},{"location":"getting-started/#configuration-file","title":"Configuration File","text":"<p>The configuration file <code>.slurm-kit/config.yaml</code> controls slurmkit behavior:</p> <pre><code># Directory structure\njobs_dir: jobs/\ncollections_dir: .job-collections/\nsync_dir: .slurm-kit/sync/\n\n# Output file patterns (tried in order)\noutput_patterns:\n  - \"{job_name}.{job_id}.out\"\n  - \"{job_name}.{job_id}.*.out\"\n  - \"slurm-{job_id}.out\"\n\n# Default SLURM arguments\nslurm_defaults:\n  partition: gpu\n  time: \"24:00:00\"\n  mem: \"32G\"\n\n# Job directory structure\njob_structure:\n  scripts_subdir: job_scripts/\n  logs_subdir: logs/\n\n# CLI UI defaults\nui:\n  mode: plain\n\n# W&amp;B settings (optional)\nwandb:\n  entity: your_username\n  default_projects:\n    - project-a\n    - project-b\n</code></pre>"},{"location":"getting-started/#basic-workflow","title":"Basic Workflow","text":""},{"location":"getting-started/#1-check-job-status","title":"1. Check Job Status","text":"<p>View the status of all jobs:</p> <pre><code>slurmkit status\n</code></pre> <p>Or view jobs in a specific experiment:</p> <pre><code>slurmkit status my_experiment\n</code></pre> <p>Options: - <code>--state running</code> - Filter by state (running, pending, completed, failed) - <code>--format json</code> - Output as JSON</p>"},{"location":"getting-started/#2-find-job-output","title":"2. Find Job Output","text":"<p>Locate output file for a specific job:</p> <pre><code>slurmkit find 12345678\n</code></pre> <p>Options: - <code>--preview</code> - Show file preview - <code>--open</code> - Open in editor</p>"},{"location":"getting-started/#3-generate-jobs","title":"3. Generate Jobs","text":"<p>Create a job spec file <code>job_spec.yaml</code>:</p> <pre><code>name: my_experiment\ndescription: \"Hyperparameter sweep\"\n\ntemplate: templates/train.job.j2\noutput_dir: jobs/my_exp/job_scripts\nlogs_dir: jobs/my_exp/logs\n\nparameters:\n  mode: grid\n  values:\n    learning_rate: [0.001, 0.01, 0.1]\n    batch_size: [32, 64]\n\nslurm_args:\n  defaults:\n    partition: gpu\n    time: \"24:00:00\"\n    mem: \"32G\"\n    gpus: 1\n\njob_name_pattern: \"{{ model }}_lr{{ learning_rate }}_bs{{ batch_size }}\"\n</code></pre> <p>Generate scripts:</p> <pre><code>slurmkit generate job_spec.yaml --collection my_experiment\n</code></pre>"},{"location":"getting-started/#4-submit-jobs","title":"4. Submit Jobs","text":"<p>Submit all generated jobs:</p> <pre><code>slurmkit submit --collection my_experiment\n</code></pre> <p>Or submit specific scripts:</p> <pre><code>slurmkit submit jobs/my_exp/job_scripts/\n</code></pre>"},{"location":"getting-started/#5-track-collection-status","title":"5. Track Collection Status","text":"<p>View collection details:</p> <pre><code>slurmkit collection show my_experiment\n\n# Rich output (if Rich is installed)\nslurmkit --ui rich collection analyze my_experiment\n</code></pre> <p>Update job states:</p> <pre><code>slurmkit collection update my_experiment\n</code></pre>"},{"location":"getting-started/#6-resubmit-failed-jobs","title":"6. Resubmit Failed Jobs","text":"<p>Resubmit failed jobs from a collection:</p> <pre><code>slurmkit resubmit --collection my_experiment --filter failed\n</code></pre>"},{"location":"getting-started/#7-clean-up","title":"7. Clean Up","text":"<p>Remove output files from failed jobs:</p> <pre><code>slurmkit clean outputs my_experiment --threshold 300 --min-age 3\n</code></pre>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<ul> <li>See Job Generation for advanced template usage</li> <li>See Collections for collection management</li> <li>See Configuration for all config options</li> <li>See Cross-Cluster Sync for multi-cluster workflows</li> </ul>"},{"location":"job-generation/","title":"Job Generation","text":"<p>slurmkit provides powerful tools for generating SLURM job scripts from templates and parameter specifications.</p>"},{"location":"job-generation/#overview","title":"Overview","text":"<p>Job generation combines: - Jinja2 templates - Define the structure of your job scripts - Parameter specifications - Define variations (grid or list) - SLURM argument logic - Optionally customize resources per job - Collections - Track generated jobs</p>"},{"location":"job-generation/#quick-start","title":"Quick Start","text":""},{"location":"job-generation/#1-create-a-template","title":"1. Create a Template","text":"<p>Create a Jinja2 template file <code>templates/train.job.j2</code>:</p> <pre><code>#!/bin/bash\n#SBATCH --job-name={{ job_name }}\n#SBATCH --partition={{ slurm.partition }}\n#SBATCH --time={{ slurm.time }}\n#SBATCH --mem={{ slurm.mem }}\n#SBATCH --gres=gpu:{{ slurm.gpus }}\n#SBATCH --output={{ logs_dir }}/{{ job_name }}.%j.out\n\n# Load environment\nsource ~/.bashrc\nconda activate myenv\n\n# Run training\npython train.py \\\n    --learning-rate {{ learning_rate }} \\\n    --batch-size {{ batch_size }} \\\n    --model {{ model }}\n</code></pre>"},{"location":"job-generation/#2-create-a-job-spec","title":"2. Create a Job Spec","text":"<p>Create <code>experiments/exp1/job_spec.yaml</code>:</p> <pre><code>name: exp1_sweep\ndescription: \"Learning rate and batch size sweep\"\n\ntemplate: ../../templates/train.job.j2\noutput_dir: job_scripts\nlogs_dir: logs\n\nparameters:\n  mode: grid\n  values:\n    learning_rate: [0.001, 0.01, 0.1]\n    batch_size: [32, 64]\n    model: [resnet18]\n\nslurm_args:\n  defaults:\n    partition: gpu\n    time: \"24:00:00\"\n    mem: \"32G\"\n    gpus: 1\n\njob_name_pattern: \"{{ model }}_lr{{ learning_rate }}_bs{{ batch_size }}\"\n</code></pre>"},{"location":"job-generation/#3-generate-jobs","title":"3. Generate Jobs","text":"<pre><code>cd experiments/exp1\nslurmkit generate job_spec.yaml --collection exp1\n\n# Preview without writing\nslurmkit generate job_spec.yaml --dry-run\n</code></pre>"},{"location":"job-generation/#job-spec-reference","title":"Job Spec Reference","text":""},{"location":"job-generation/#full-job-spec-format","title":"Full Job Spec Format","text":"<pre><code># Descriptive name for this job spec\nname: my_experiment\n\n# Human-readable description\ndescription: \"Hyperparameter sweep for ResNet training\"\n\n# Path to Jinja2 template (relative to spec file or absolute)\ntemplate: templates/train.job.j2\n\n# Output directory for generated scripts\noutput_dir: job_scripts\n\n# Directory for job outputs (used in templates)\nlogs_dir: logs\n\n# Parameter specification\nparameters:\n  # Mode: \"grid\" for all combinations, \"list\" for explicit list\n  mode: grid\n  values:\n    learning_rate: [0.001, 0.01, 0.1]\n    batch_size: [32, 64]\n    model: [resnet18, resnet50]\n  # Optional filter for grid mode\n  filter:\n    file: params_filter.py\n    function: include_params\n\n# SLURM arguments\nslurm_args:\n  # Default values\n  defaults:\n    partition: gpu\n    time: \"24:00:00\"\n    mem: \"32G\"\n    gpus: 1\n\n  # Optional: Python function for dynamic logic\n  logic:\n    file: slurm_logic.py\n    function: get_slurm_args\n\n# Jinja2 pattern for job names\njob_name_pattern: \"{{ model }}_lr{{ learning_rate }}_bs{{ batch_size }}\"\n\n# Optional collection-specific notification overrides\n# (same shape as .slurm-kit/config.yaml notifications)\nnotifications:\n  defaults:\n    events: [job_failed]\n  job:\n    ai:\n      enabled: false\n      callback: null\n  collection_final:\n    attempt_mode: latest\n    min_support: 3\n    top_k: 10\n    include_failed_output_tail_lines: 20\n    ai:\n      enabled: false\n      callback: null\n  routes:\n    - name: exp_slack\n      type: slack\n      url: \"${SLACK_WEBHOOK_URL}\"\n      events: [job_failed, collection_failed]\n</code></pre> <p>Notification precedence for <code>slurmkit notify</code>: - If collection generation metadata includes <code>spec_path</code>, slurmkit loads the collection's <code>spec.yaml</code> at notify-time. - If top-level <code>notifications</code> exists in the spec, it overrides global notifications via deep merge. - Dict keys deep-merge; list values (including <code>notifications.routes</code>) replace the global list. - If spec is missing/unreadable/malformed, slurmkit warns and falls back to <code>.slurm-kit/config.yaml</code>.</p>"},{"location":"job-generation/#parameter-modes","title":"Parameter Modes","text":""},{"location":"job-generation/#grid-mode","title":"Grid Mode","text":"<p>All combinations of parameter values:</p> <pre><code>parameters:\n  mode: grid\n  values:\n    lr: [0.001, 0.01]\n    bs: [32, 64]\n</code></pre> <p>Generates 4 jobs: <code>(0.001, 32), (0.001, 64), (0.01, 32), (0.01, 64)</code></p>"},{"location":"job-generation/#grid-filtering","title":"Grid Filtering","text":"<p>For incompatible parameter combinations, add a filter function to trim the grid:</p> <pre><code>parameters:\n  mode: grid\n  values:\n    algorithm: [algo_a, algo_b]\n    dataset: [small, large]\n  filter:\n    file: params_filter.py\n    function: include_params  # Optional, defaults to \"include_params\"\n</code></pre> <pre><code># params_filter.py\ndef include_params(params: dict) -&gt; bool:\n    # Exclude algo_b with small dataset\n    return not (params.get(\"algorithm\") == \"algo_b\" and params.get(\"dataset\") == \"small\")\n</code></pre> <p>Filters only apply to grid mode; list mode ignores them. Filter file paths are resolved relative to the job spec file.</p>"},{"location":"job-generation/#list-mode","title":"List Mode","text":"<p>Explicit list of parameter combinations:</p> <pre><code>parameters:\n  mode: list\n  values:\n    - {lr: 0.001, bs: 32, model: small}\n    - {lr: 0.01, bs: 64, model: large}\n    - {lr: 0.1, bs: 128, model: xlarge}\n</code></pre>"},{"location":"job-generation/#template-variables","title":"Template Variables","text":"<p>Templates have access to these variables:</p> Variable Description <code>job_name</code> Generated job name <code>slurm</code> Dictionary of SLURM arguments <code>logs_dir</code> Logs directory path <code>&lt;param&gt;</code> Each parameter from your specification"},{"location":"job-generation/#example-template","title":"Example Template","text":"<pre><code>#!/bin/bash\n#SBATCH --job-name={{ job_name }}\n#SBATCH --partition={{ slurm.partition }}\n#SBATCH --time={{ slurm.time }}\n#SBATCH --mem={{ slurm.mem }}\n{% if slurm.gpus is defined %}\n#SBATCH --gres=gpu:{{ slurm.gpus }}\n{% endif %}\n#SBATCH --output={{ logs_dir }}/{{ job_name }}.%j.out\n#SBATCH --error={{ logs_dir }}/{{ job_name }}.%j.err\n\necho \"Job: {{ job_name }}\"\necho \"Learning rate: {{ learning_rate }}\"\necho \"Batch size: {{ batch_size }}\"\n\npython train.py \\\n    --lr {{ learning_rate }} \\\n    --bs {{ batch_size }} \\\n    {% if epochs is defined %}--epochs {{ epochs }}{% endif %}\n</code></pre>"},{"location":"job-generation/#dynamic-slurm-arguments","title":"Dynamic SLURM Arguments","text":"<p>For complex resource requirements, use a Python function:</p>"},{"location":"job-generation/#slurm_logicpy","title":"slurm_logic.py","text":"<pre><code>def get_slurm_args(params: dict, defaults: dict) -&gt; dict:\n    \"\"\"\n    Customize SLURM arguments based on job parameters.\n\n    Args:\n        params: Job parameters (learning_rate, batch_size, etc.)\n        defaults: Default SLURM args from job spec\n\n    Returns:\n        Final SLURM arguments dictionary\n    \"\"\"\n    args = defaults.copy()\n\n    # Larger models need more memory\n    model = params.get('model', 'resnet18')\n    if model == 'resnet50':\n        args['mem'] = '64G'\n        args['gpus'] = 2\n    elif model == 'resnet101':\n        args['mem'] = '128G'\n        args['gpus'] = 4\n\n    # Larger batch sizes need more memory\n    batch_size = params.get('batch_size', 32)\n    if batch_size &gt;= 128:\n        args['mem'] = '64G'\n\n    # Long training needs more time\n    epochs = params.get('epochs', 100)\n    if epochs &gt; 500:\n        args['time'] = '72:00:00'\n\n    return args\n</code></pre>"},{"location":"job-generation/#reference-in-job-spec","title":"Reference in Job Spec","text":"<pre><code>slurm_args:\n  defaults:\n    partition: gpu\n    time: \"24:00:00\"\n    mem: \"32G\"\n    gpus: 1\n\n  logic:\n    file: slurm_logic.py\n    function: get_slurm_args  # Optional, defaults to \"get_slurm_args\"\n</code></pre>"},{"location":"job-generation/#job-naming","title":"Job Naming","text":""},{"location":"job-generation/#default-naming","title":"Default Naming","text":"<p>Without a pattern, job names are parameter key-value pairs:</p> <pre><code>learning_rate0.001_batch_size32_modelresnet18\n</code></pre>"},{"location":"job-generation/#custom-pattern","title":"Custom Pattern","text":"<p>Use Jinja2 for readable names:</p> <pre><code>job_name_pattern: \"{{ model }}_lr{{ learning_rate }}_bs{{ batch_size }}\"\n</code></pre> <p>Produces:</p> <pre><code>resnet18_lr0.001_bs32\n</code></pre>"},{"location":"job-generation/#tips","title":"Tips","text":"<ul> <li>Keep names short (SLURM limits job name length)</li> <li>Include key distinguishing parameters</li> <li>Avoid spaces and special characters</li> </ul>"},{"location":"job-generation/#cli-commands","title":"CLI Commands","text":""},{"location":"job-generation/#generate-from-spec-file","title":"Generate from Spec File","text":"<pre><code>slurmkit generate job_spec.yaml\nslurmkit generate job_spec.yaml --collection my_exp\nslurmkit generate job_spec.yaml --dry-run\n</code></pre>"},{"location":"job-generation/#generate-with-cli-arguments","title":"Generate with CLI Arguments","text":"<pre><code>slurmkit generate \\\n    --template templates/train.job.j2 \\\n    --params params.yaml \\\n    --output-dir jobs/exp1/scripts \\\n    --collection exp1\n</code></pre>"},{"location":"job-generation/#programmatic-usage","title":"Programmatic Usage","text":"<pre><code>from slurmkit.generate import JobGenerator, generate_jobs_from_spec\nfrom slurmkit.collections import CollectionManager\n\n# From spec file\nresults = generate_jobs_from_spec(\n    \"job_spec.yaml\",\n    collection_name=\"my_experiment\",\n)\n\n# Programmatically\ngenerator = JobGenerator(\n    template_path=\"templates/train.job.j2\",\n    parameters={\n        \"mode\": \"grid\",\n        \"values\": {\n            \"learning_rate\": [0.001, 0.01],\n            \"batch_size\": [32, 64],\n        }\n    },\n    slurm_defaults={\"partition\": \"gpu\", \"time\": \"24:00:00\"},\n    job_name_pattern=\"{{ learning_rate }}_{{ batch_size }}\",\n)\n\n# Preview\nprint(generator.preview(0))\nprint(f\"Will generate {generator.count_jobs()} jobs\")\n\n# Generate\nmanager = CollectionManager()\ncollection = manager.get_or_create(\"my_experiment\")\n\nresults = generator.generate(\n    output_dir=\"jobs/exp1/scripts\",\n    collection=collection,\n)\n\nmanager.save(collection)\n</code></pre>"},{"location":"notifications/","title":"Notifications","text":"<p><code>slurmkit</code> supports webhook/chat and SMTP email notifications for job and collection lifecycle events.</p> <p>Supported transport types: - <code>webhook</code> - <code>slack</code> - <code>discord</code> - <code>email</code> (SMTP)</p> <p>Default behavior remains failure-first: - <code>notify job</code> defaults to <code>--on failed</code> - route event subscription defaults to <code>job_failed</code></p>"},{"location":"notifications/#configuration","title":"Configuration","text":"<p>Add notification settings to <code>.slurm-kit/config.yaml</code>:</p> <pre><code>notifications:\n  defaults:\n    events: [job_failed]\n    timeout_seconds: 5\n    max_attempts: 3\n    backoff_seconds: 0.5\n    output_tail_lines: 40\n\n  job:\n    ai:\n      enabled: false\n      callback: null\n\n  collection_final:\n    attempt_mode: latest\n    min_support: 3\n    top_k: 10\n    include_failed_output_tail_lines: 20\n    ai:\n      enabled: false\n      callback: null\n\n  routes:\n    - name: team_slack\n      type: slack\n      url: \"${SLACK_WEBHOOK_URL}\"\n      events: [job_failed, collection_failed]\n\n    - name: personal_discord\n      type: discord\n      url: \"${DISCORD_WEBHOOK_URL}\"\n      events: [job_failed, job_completed]\n\n    - name: custom_ops\n      type: webhook\n      url: \"${OPS_WEBHOOK_URL}\"\n      headers:\n        Authorization: \"Bearer ${OPS_WEBHOOK_TOKEN}\"\n      events: [job_failed, collection_failed, collection_completed]\n\n    - name: team_email\n      type: email\n      to: [\"ops@example.com\", \"ml@example.com\"]\n      from: \"${SLURMKIT_EMAIL_FROM}\"\n      smtp_host: \"${SMTP_HOST}\"\n      smtp_port: 587\n      smtp_username: \"${SMTP_USER}\"\n      smtp_password: \"${SMTP_PASSWORD}\"\n      smtp_starttls: true\n      smtp_ssl: false\n      events: [job_failed, collection_failed]\n</code></pre> <p>Route-level settings override <code>notifications.defaults</code>.</p> <p><code>url</code>, <code>headers</code>, and email fields support <code>${ENV_VAR}</code> interpolation. Missing env vars are reported as route configuration errors at runtime.</p> <p>For <code>type: email</code>: - required fields: <code>to</code>, <code>from</code>, <code>smtp_host</code> - <code>to</code> supports string, comma-separated string, or list of strings - <code>smtp_starttls</code> and <code>smtp_ssl</code> cannot both be <code>true</code> - <code>smtp_username</code> and <code>smtp_password</code> must be set together (or both omitted)</p>"},{"location":"notifications/#collection-specific-overrides-from-specyaml","title":"Collection-Specific Overrides from <code>spec.yaml</code>","text":"<p>When a collection was created via <code>slurmkit generate --spec-file ...</code>, slurmkit stores <code>meta.generation.spec_path</code> in the collection metadata. <code>notify job</code> and <code>notify collection-final</code> use this precedence:</p> <ol> <li>Top-level <code>notifications</code> in the collection's <code>spec.yaml</code></li> <li>Global <code>.slurm-kit/config.yaml</code> <code>notifications</code></li> </ol> <p>Merge semantics: - Dictionary fields deep-merge (spec values override global values). - List fields replace (not append), including <code>notifications.routes</code>.</p> <p>If the spec file is missing, unreadable, or malformed, slurmkit prints a context warning and falls back to the global config.</p> <p>Example <code>job_spec.yaml</code> override:</p> <pre><code>notifications:\n  defaults:\n    output_tail_lines: 15\n  job:\n    ai:\n      enabled: true\n      callback: \"collection_ai_callback:summarize_job_payload\"\n  collection_final:\n    ai:\n      enabled: true\n      callback: \"collection_ai_callback:summarize_collection_report\"\n</code></pre> <p>See the runnable demo in <code>/Users/awni/Documents/project-code/slurmkit/examples/demo_project/README.md</code>.</p>"},{"location":"notifications/#commands","title":"Commands","text":""},{"location":"notifications/#test-routes","title":"Test routes","text":"<pre><code>slurmkit notify test\nslurmkit notify test --route team_slack\nslurmkit notify test --dry-run\nslurmkit notify test --route team_email --dry-run\n# then run live (no --dry-run) once SMTP/env vars are configured\nslurmkit notify test --route team_email\n</code></pre>"},{"location":"notifications/#send-job-notification","title":"Send job notification","text":"<pre><code>slurmkit notify job --job-id 12345 --exit-code 1\nslurmkit notify job --job-id 12345 --exit-code 0 --on always\nslurmkit notify job --job-id 12345 --route team_slack --route custom_ops\nslurmkit notify job --job-id 12345 --dry-run\n</code></pre>"},{"location":"notifications/#send-collection-final-notification","title":"Send collection-final notification","text":"<pre><code>slurmkit notify collection-final --job-id 12345\nslurmkit notify collection-final --job-id 12345 --collection exp1\nslurmkit notify collection-final --job-id 12345 --trigger-exit-code 0\nslurmkit notify collection-final --job-id 12345 --route custom_ops --strict\nslurmkit notify collection-final --job-id 12345 --no-refresh --dry-run\n</code></pre> <p><code>notify collection-final</code> behavior: - refreshes collection state before finality check (unless <code>--no-refresh</code>) - uses latest-attempt semantics to classify each logical job - sends <code>collection_completed</code> or <code>collection_failed</code> only when collection is terminal - can treat collection as terminal when the only active effective row is the trigger job (<code>--job-id</code>) - when that fallback path is used: <code>--trigger-exit-code 0</code> infers completed, non-zero infers failed - if fallback is used without <code>--trigger-exit-code</code>, trigger state is inferred as <code>unknown</code> and a warning is printed - deduplicates by terminal-state fingerprint (use <code>--force</code> to bypass)</p>"},{"location":"notifications/#job-script-integration","title":"Job Script Integration","text":"<p>Recommended shell pattern to preserve original job exit code while triggering both job and collection-final notifications:</p> <pre><code>trap 'rc=$?; slurmkit notify job --job-id \"${SLURM_JOB_ID}\" --exit-code \"${rc}\"; slurmkit notify collection-final --job-id \"${SLURM_JOB_ID}\" --trigger-exit-code \"${rc}\"; exit \"${rc}\"' EXIT\n</code></pre> <p>If your script handles exits explicitly, use equivalent end-of-script flow:</p> <pre><code>rc=$?\nslurmkit notify job --job-id \"${SLURM_JOB_ID}\" --exit-code \"${rc}\"\nslurmkit notify collection-final --job-id \"${SLURM_JOB_ID}\" --trigger-exit-code \"${rc}\"\nexit \"${rc}\"\n</code></pre>"},{"location":"notifications/#event-model","title":"Event Model","text":"<p><code>notify job</code> derives event from exit code: - <code>exit_code != 0</code> -&gt; <code>job_failed</code> - <code>exit_code == 0</code> -&gt; <code>job_completed</code></p> <p><code>notify collection-final</code> emits: - <code>collection_failed</code> when terminal and any effective job is failed/unknown - <code>collection_completed</code> when terminal and all effective jobs are completed</p> <p>By default (<code>--on failed</code>), completed job notifications are skipped.</p>"},{"location":"notifications/#canonical-webhook-payload","title":"Canonical Webhook Payload","text":"<p>For <code>type: webhook</code>, slurmkit sends stable <code>schema_version: v1</code> JSON.</p> <p>Job payload includes: - <code>event</code> - <code>generated_at</code> - <code>context_source</code> (<code>collection_match</code>, <code>env_only</code>, <code>ambiguous_match</code>) - <code>job</code> - <code>collection</code> (when uniquely resolved) - <code>ai_status</code> - optional <code>ai_summary</code> - <code>host</code> - <code>meta</code> (route name/type)</p> <p>Collection-final payload additionally includes: - <code>collection_report</code> (summary counts, failed rows, risky/stable values, recommendations) - <code>trigger_job_id</code> - <code>ai_status</code> - optional <code>ai_summary</code></p> <p>Test payload includes deterministic baseline fields and does not run AI callbacks.</p> <p>For <code>slack</code>/<code>discord</code>, slurmkit sends a human-readable summary with key metadata.</p> <p>For <code>email</code>, slurmkit sends plain-text emails through SMTP with built-in subject/body formatting.</p>"},{"location":"sync/","title":"Cross-Cluster Synchronization","text":"<p>slurmkit supports working across multiple compute clusters within a shared repository. The sync feature allows you to:</p> <ul> <li>Track job states across different clusters</li> <li>Share status via git-tracked files</li> <li>View combined status from any cluster</li> </ul>"},{"location":"sync/#how-it-works","title":"How It Works","text":"<ol> <li>Local sync - Each cluster writes its own sync file</li> <li>Git sharing - Sync files are committed and pushed</li> <li>Combined view - Read sync files from all clusters</li> </ol> <pre><code>.slurm-kit/sync/\n\u251c\u2500\u2500 cluster-a.yaml    # Sync file from cluster A\n\u251c\u2500\u2500 cluster-b.yaml    # Sync file from cluster B\n\u2514\u2500\u2500 cluster-c.yaml    # Sync file from cluster C\n</code></pre>"},{"location":"sync/#sync-file-format","title":"Sync File Format","text":"<p>Each sync file contains the state of collections on that cluster:</p> <pre><code>cluster: cluster-a\nsynced_at: \"2025-01-15T16:00:00\"\ntotal_collections: 2\ntotal_jobs_updated: 5\n\ncollections:\n  my_experiment:\n    name: my_experiment\n    description: \"Training sweep\"\n    updated_jobs: 3\n    total: 12\n    pending: 0\n    running: 2\n    completed: 8\n    failed: 2\n    jobs:\n      - job_name: train_lr0.001\n        job_id: \"12345678\"\n        state: COMPLETED\n        hostname: cluster-a\n      - job_name: train_lr0.01\n        job_id: \"12345679\"\n        state: FAILED\n        hostname: cluster-a\n        resubmissions:\n          - job_id: \"12345700\"\n            state: RUNNING\n            hostname: cluster-a\n\n  exp2:\n    # ... another collection\n</code></pre>"},{"location":"sync/#basic-workflow","title":"Basic Workflow","text":""},{"location":"sync/#1-sync-local-state","title":"1. Sync Local State","text":"<p>On each cluster, run:</p> <pre><code>slurmkit sync\n</code></pre> <p>This: - Refreshes job states from SLURM - Updates collection files - Writes sync file for current cluster</p>"},{"location":"sync/#2-share-via-git","title":"2. Share via Git","text":"<p>Commit and push sync file:</p> <pre><code>slurmkit sync --push\n</code></pre> <p>Or manually:</p> <pre><code>git add .slurm-kit/sync/\ngit commit -m \"Sync job states\"\ngit push\n</code></pre>"},{"location":"sync/#3-pull-on-other-clusters","title":"3. Pull on Other Clusters","text":"<p>On other clusters:</p> <pre><code>git pull\nslurmkit collection show my_experiment\n</code></pre>"},{"location":"sync/#cli-commands","title":"CLI Commands","text":""},{"location":"sync/#basic-sync","title":"Basic Sync","text":"<pre><code># Sync all collections\nslurmkit sync\n\n# Sync specific collections\nslurmkit sync --collection exp1 exp2\n\n# Sync and push to git\nslurmkit sync --push\n</code></pre>"},{"location":"sync/#view-combined-status","title":"View Combined Status","text":"<p>From Python or by reading sync files:</p> <pre><code>from slurmkit.sync import SyncManager\n\nmanager = SyncManager()\n\n# List all sync files (all clusters)\nclusters = manager.list_sync_files()\nprint(f\"Clusters: {clusters}\")\n\n# Get combined status for a collection\nstatus = manager.get_combined_status(\"my_experiment\")\n\nfor job in status[\"jobs\"]:\n    print(f\"{job['job_name']}: {job['overall_state']}\")\n    for sub in job[\"submissions\"]:\n        print(f\"  - {sub['cluster']}: {sub['state']}\")\n</code></pre>"},{"location":"sync/#multi-cluster-experiment-workflow","title":"Multi-Cluster Experiment Workflow","text":""},{"location":"sync/#setup","title":"Setup","text":"<ol> <li>Clone repo on each cluster</li> <li>Initialize slurmkit on each cluster</li> <li>Generate jobs (can be done on any cluster)</li> </ol>"},{"location":"sync/#running-jobs","title":"Running Jobs","text":"<p>On cluster A: <pre><code>slurmkit submit --collection my_experiment\nslurmkit sync --push\n</code></pre></p> <p>On cluster B: <pre><code>git pull\nslurmkit submit --collection my_experiment\nslurmkit sync --push\n</code></pre></p>"},{"location":"sync/#monitoring","title":"Monitoring","text":"<p>From any cluster: <pre><code>git pull\nslurmkit collection show my_experiment\n</code></pre></p>"},{"location":"sync/#resubmitting","title":"Resubmitting","text":"<p>On the cluster where jobs failed: <pre><code>slurmkit resubmit --collection my_experiment --filter failed\nslurmkit sync --push\n</code></pre></p>"},{"location":"sync/#hostname-identification","title":"Hostname Identification","text":"<p>Clusters are identified by hostname. The hostname is recorded when:</p> <ul> <li>Collections are created</li> <li>Jobs are submitted</li> <li>Jobs are resubmitted</li> </ul> <p>This allows tracking which cluster each job ran on.</p>"},{"location":"sync/#best-practices","title":"Best Practices","text":"<ol> <li>Sync after changes - Run <code>slurmkit sync</code> after submitting or resubmitting</li> <li>Pull before checking - Run <code>git pull</code> before viewing cross-cluster status</li> <li>Use --push for updates - Combine sync and push for convenience</li> <li>Commit messages - The <code>--push</code> option creates descriptive commit messages</li> </ol>"},{"location":"sync/#conflict-resolution","title":"Conflict Resolution","text":"<p>Sync files are per-cluster, so conflicts are rare. If they occur:</p> <ol> <li>The conflict will be in <code>.slurm-kit/sync/&lt;hostname&gt;.yaml</code></li> <li>Keep the version from the cluster that owns the file</li> <li>Re-sync on that cluster if needed</li> </ol>"},{"location":"sync/#programmatic-usage","title":"Programmatic Usage","text":"<pre><code>from slurmkit.sync import SyncManager, sync_jobs\n\n# Quick sync\nresult = sync_jobs(push=True)\nprint(f\"Updated {result['total_jobs_updated']} jobs\")\n\n# Detailed usage\nmanager = SyncManager()\n\n# Sync specific collections\nresult = manager.sync_all(collection_names=[\"exp1\", \"exp2\"])\n\n# Read sync files from all clusters\nall_sync = manager.get_all_sync_data()\nfor hostname, data in all_sync.items():\n    print(f\"\\n{hostname}:\")\n    print(f\"  Last synced: {data['synced_at']}\")\n    for name, coll in data['collections'].items():\n        print(f\"  {name}: {coll['completed']}/{coll['total']} completed\")\n\n# Combined status\nstatus = manager.get_combined_status(\"my_experiment\")\nfor job in status[\"jobs\"]:\n    # Check if any submission succeeded\n    if job[\"overall_state\"] == \"COMPLETED\":\n        print(f\"\u2713 {job['job_name']}\")\n    else:\n        print(f\"\u2717 {job['job_name']}: {job['overall_state']}\")\n</code></pre>"},{"location":"sync/#limitations","title":"Limitations","text":"<ul> <li>Sync is manual (run <code>slurmkit sync</code> to update)</li> <li>Requires git for sharing (or manual file copying)</li> <li>Job IDs are cluster-specific</li> <li>States only update when sync is run on the cluster</li> </ul>"},{"location":"sync/#future-enhancements","title":"Future Enhancements","text":"<p>See <code>todo/cross-cluster-sync.md</code> for planned improvements.</p>"},{"location":"api/","title":"API Reference","text":"<p>This section provides detailed API documentation for the slurmkit Python library.</p>"},{"location":"api/#overview","title":"Overview","text":"<p>slurmkit exposes the following main components:</p> Module Description Config Configuration management Collections Job collection tracking Job Generation Template-based job generation SLURM Utilities SLURM interaction functions Sync Cross-cluster synchronization"},{"location":"api/#quick-import","title":"Quick Import","text":"<pre><code>from slurmkit import (\n    # Configuration\n    Config,\n    get_config,\n    # Collections\n    Collection,\n    CollectionManager,\n    # SLURM utilities\n    get_job_status,\n    get_sacct_info,\n    get_pending_jobs,\n    submit_job,\n    find_job_output,\n    # Job generation\n    JobGenerator,\n)\n</code></pre>"},{"location":"api/#module-organization","title":"Module Organization","text":"<pre><code>slurmkit/\n\u251c\u2500\u2500 config.py       # Config class and utilities\n\u251c\u2500\u2500 collections.py  # Collection and CollectionManager\n\u251c\u2500\u2500 generate.py     # JobGenerator and parameter expansion\n\u251c\u2500\u2500 slurm.py        # SLURM command wrappers\n\u251c\u2500\u2500 sync.py         # SyncManager for cross-cluster sync\n\u251c\u2500\u2500 wandb_utils.py  # W&amp;B integration utilities\n\u2514\u2500\u2500 cli/            # Command-line interface\n</code></pre>"},{"location":"api/collections/","title":"Collections","text":"<p>Job collection management for tracking related SLURM jobs.</p>"},{"location":"api/collections/#overview","title":"Overview","text":"<p>Collections allow you to group related jobs together, track their states, and perform batch operations. Each collection stores:</p> <ul> <li>Job metadata (parameters, script paths)</li> <li>Job IDs and submission history</li> <li>Current job states</li> <li>Timestamps</li> </ul>"},{"location":"api/collections/#classes","title":"Classes","text":""},{"location":"api/collections/#collection","title":"Collection","text":""},{"location":"api/collections/#slurmkit.collections.Collection","title":"Collection","text":"<pre><code>Collection(name: str, description: str = '', created_at: Optional[str] = None, updated_at: Optional[str] = None, cluster: Optional[str] = None, parameters: Optional[Dict[str, Any]] = None, jobs: Optional[List[Dict[str, Any]]] = None, meta: Optional[Dict[str, Any]] = None)\n</code></pre> <p>A collection of related SLURM jobs.</p> <p>Collections track jobs that are generated and submitted together, including their parameters, states, and resubmission history.</p> <p>Attributes:</p> Name Type Description <code>name</code> <p>Collection name (also used as filename).</p> <code>description</code> <p>Human-readable description.</p> <code>created_at</code> <p>Creation timestamp.</p> <code>updated_at</code> <p>Last update timestamp.</p> <code>cluster</code> <p>Hostname where collection was created.</p> <code>parameters</code> <p>Generation parameters (grid/list specification).</p> <code>jobs</code> <code>List[Dict[str, Any]]</code> <p>List of job entries.</p> Example <p>collection = Collection(\"my_experiment\") collection.add_job( ...     job_name=\"train_lr0.01\", ...     script_path=\"jobs/exp/train_lr0.01.job\", ...     parameters={\"learning_rate\": 0.01} ... ) collection.save()</p> <p>Initialize a collection.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Collection name.</p> required <code>description</code> <code>str</code> <p>Human-readable description.</p> <code>''</code> <code>created_at</code> <code>Optional[str]</code> <p>Creation timestamp (ISO format).</p> <code>None</code> <code>updated_at</code> <code>Optional[str]</code> <p>Last update timestamp (ISO format).</p> <code>None</code> <code>cluster</code> <code>Optional[str]</code> <p>Hostname where collection was created.</p> <code>None</code> <code>parameters</code> <code>Optional[Dict[str, Any]]</code> <p>Generation parameters specification.</p> <code>None</code> <code>jobs</code> <code>Optional[List[Dict[str, Any]]]</code> <p>List of job entries.</p> <code>None</code> <code>meta</code> <code>Optional[Dict[str, Any]]</code> <p>Collection-level metadata (e.g., notification checkpoints).</p> <code>None</code> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def __init__(\n    self,\n    name: str,\n    description: str = \"\",\n    created_at: Optional[str] = None,\n    updated_at: Optional[str] = None,\n    cluster: Optional[str] = None,\n    parameters: Optional[Dict[str, Any]] = None,\n    jobs: Optional[List[Dict[str, Any]]] = None,\n    meta: Optional[Dict[str, Any]] = None,\n):\n    \"\"\"\n    Initialize a collection.\n\n    Args:\n        name: Collection name.\n        description: Human-readable description.\n        created_at: Creation timestamp (ISO format).\n        updated_at: Last update timestamp (ISO format).\n        cluster: Hostname where collection was created.\n        parameters: Generation parameters specification.\n        jobs: List of job entries.\n        meta: Collection-level metadata (e.g., notification checkpoints).\n    \"\"\"\n    self.name = name\n    self.description = description\n    self.cluster = cluster or socket.gethostname()\n\n    now = datetime.now().isoformat(timespec=\"seconds\")\n    self.created_at = created_at or now\n    self.updated_at = updated_at or now\n\n    self.parameters = parameters or {}\n    self._jobs: List[Dict[str, Any]] = jobs or []\n    self.meta: Dict[str, Any] = meta or {}\n</code></pre>"},{"location":"api/collections/#slurmkit.collections.Collection.add_job","title":"add_job","text":"<pre><code>add_job(job_name: str, script_path: Optional[Union[str, Path]] = None, output_path: Optional[Union[str, Path]] = None, job_id: Optional[str] = None, state: Optional[str] = None, parameters: Optional[Dict[str, Any]] = None, hostname: Optional[str] = None, submitted_at: Optional[str] = None, started_at: Optional[str] = None, completed_at: Optional[str] = None) -&gt; Dict[str, Any]\n</code></pre> <p>Add a job to the collection.</p> <p>Parameters:</p> Name Type Description Default <code>job_name</code> <code>str</code> <p>Name of the job.</p> required <code>script_path</code> <code>Optional[Union[str, Path]]</code> <p>Path to the job script.</p> <code>None</code> <code>output_path</code> <code>Optional[Union[str, Path]]</code> <p>Path to the output file.</p> <code>None</code> <code>job_id</code> <code>Optional[str]</code> <p>SLURM job ID (if submitted).</p> <code>None</code> <code>state</code> <code>Optional[str]</code> <p>Current job state.</p> <code>None</code> <code>parameters</code> <code>Optional[Dict[str, Any]]</code> <p>Job-specific parameters.</p> <code>None</code> <code>hostname</code> <code>Optional[str]</code> <p>Hostname where job was submitted.</p> <code>None</code> <code>submitted_at</code> <code>Optional[str]</code> <p>Submission timestamp.</p> <code>None</code> <code>started_at</code> <code>Optional[str]</code> <p>Start timestamp.</p> <code>None</code> <code>completed_at</code> <code>Optional[str]</code> <p>Completion timestamp.</p> <code>None</code> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>The created job entry dictionary.</p> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def add_job(\n    self,\n    job_name: str,\n    script_path: Optional[Union[str, Path]] = None,\n    output_path: Optional[Union[str, Path]] = None,\n    job_id: Optional[str] = None,\n    state: Optional[str] = None,\n    parameters: Optional[Dict[str, Any]] = None,\n    hostname: Optional[str] = None,\n    submitted_at: Optional[str] = None,\n    started_at: Optional[str] = None,\n    completed_at: Optional[str] = None,\n) -&gt; Dict[str, Any]:\n    \"\"\"\n    Add a job to the collection.\n\n    Args:\n        job_name: Name of the job.\n        script_path: Path to the job script.\n        output_path: Path to the output file.\n        job_id: SLURM job ID (if submitted).\n        state: Current job state.\n        parameters: Job-specific parameters.\n        hostname: Hostname where job was submitted.\n        submitted_at: Submission timestamp.\n        started_at: Start timestamp.\n        completed_at: Completion timestamp.\n\n    Returns:\n        The created job entry dictionary.\n    \"\"\"\n    git_metadata = _get_git_metadata()\n    job_entry = {\n        \"job_name\": job_name,\n        \"job_id\": job_id,\n        \"script_path\": str(script_path) if script_path else None,\n        \"output_path\": str(output_path) if output_path else None,\n        \"state\": state,\n        \"hostname\": hostname or socket.gethostname(),\n        \"parameters\": parameters or {},\n        \"submitted_at\": submitted_at,\n        \"started_at\": started_at,\n        \"completed_at\": completed_at,\n        \"resubmissions\": [],\n        \"git_branch\": git_metadata[\"git_branch\"],\n        \"git_commit_id\": git_metadata[\"git_commit_id\"],\n    }\n\n    self._jobs.append(job_entry)\n    self._touch()\n\n    return job_entry\n</code></pre>"},{"location":"api/collections/#slurmkit.collections.Collection.get_job","title":"get_job","text":"<pre><code>get_job(job_name: str) -&gt; Optional[Dict[str, Any]]\n</code></pre> <p>Get a job entry by name.</p> <p>Parameters:</p> Name Type Description Default <code>job_name</code> <code>str</code> <p>Name of the job to find.</p> required <p>Returns:</p> Type Description <code>Optional[Dict[str, Any]]</code> <p>Job entry dictionary, or None if not found.</p> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def get_job(self, job_name: str) -&gt; Optional[Dict[str, Any]]:\n    \"\"\"\n    Get a job entry by name.\n\n    Args:\n        job_name: Name of the job to find.\n\n    Returns:\n        Job entry dictionary, or None if not found.\n    \"\"\"\n    for job in self._jobs:\n        if job[\"job_name\"] == job_name:\n            return job\n    return None\n</code></pre>"},{"location":"api/collections/#slurmkit.collections.Collection.update_job","title":"update_job","text":"<pre><code>update_job(job_name: str, job_id: Optional[str] = None, state: Optional[str] = None, output_path: Optional[Union[str, Path]] = None, submitted_at: Optional[str] = None, started_at: Optional[str] = None, completed_at: Optional[str] = None, **kwargs: Any) -&gt; bool\n</code></pre> <p>Update an existing job entry.</p> <p>Parameters:</p> Name Type Description Default <code>job_name</code> <code>str</code> <p>Name of the job to update.</p> required <code>job_id</code> <code>Optional[str]</code> <p>New SLURM job ID.</p> <code>None</code> <code>state</code> <code>Optional[str]</code> <p>New state.</p> <code>None</code> <code>output_path</code> <code>Optional[Union[str, Path]]</code> <p>New output path.</p> <code>None</code> <code>submitted_at</code> <code>Optional[str]</code> <p>Submission timestamp.</p> <code>None</code> <code>started_at</code> <code>Optional[str]</code> <p>Start timestamp.</p> <code>None</code> <code>completed_at</code> <code>Optional[str]</code> <p>Completion timestamp.</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional fields to update.</p> <code>{}</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if job was found and updated, False otherwise.</p> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def update_job(\n    self,\n    job_name: str,\n    job_id: Optional[str] = None,\n    state: Optional[str] = None,\n    output_path: Optional[Union[str, Path]] = None,\n    submitted_at: Optional[str] = None,\n    started_at: Optional[str] = None,\n    completed_at: Optional[str] = None,\n    **kwargs: Any,\n) -&gt; bool:\n    \"\"\"\n    Update an existing job entry.\n\n    Args:\n        job_name: Name of the job to update.\n        job_id: New SLURM job ID.\n        state: New state.\n        output_path: New output path.\n        submitted_at: Submission timestamp.\n        started_at: Start timestamp.\n        completed_at: Completion timestamp.\n        **kwargs: Additional fields to update.\n\n    Returns:\n        True if job was found and updated, False otherwise.\n    \"\"\"\n    job = self.get_job(job_name)\n    if job is None:\n        return False\n\n    if job_id is not None:\n        job[\"job_id\"] = job_id\n    if state is not None:\n        job[\"state\"] = state\n    if output_path is not None:\n        job[\"output_path\"] = str(output_path)\n    if submitted_at is not None:\n        job[\"submitted_at\"] = submitted_at\n    if started_at is not None:\n        job[\"started_at\"] = started_at\n    if completed_at is not None:\n        job[\"completed_at\"] = completed_at\n\n    for key, value in kwargs.items():\n        job[key] = value\n\n    self._touch()\n    return True\n</code></pre>"},{"location":"api/collections/#slurmkit.collections.Collection.add_resubmission","title":"add_resubmission","text":"<pre><code>add_resubmission(job_name: str, job_id: str, extra_params: Optional[Dict[str, Any]] = None, submission_group: Optional[str] = None, hostname: Optional[str] = None, attempt_job_name: Optional[str] = None, attempt_script_path: Optional[Union[str, Path]] = None, attempt_parameters: Optional[Dict[str, Any]] = None, regenerated: Optional[bool] = None) -&gt; bool\n</code></pre> <p>Record a job resubmission.</p> <p>Parameters:</p> Name Type Description Default <code>job_name</code> <code>str</code> <p>Name of the original job.</p> required <code>job_id</code> <code>str</code> <p>New SLURM job ID from resubmission.</p> required <code>extra_params</code> <code>Optional[Dict[str, Any]]</code> <p>Additional parameters used for resubmission.</p> <code>None</code> <code>hostname</code> <code>Optional[str]</code> <p>Hostname where resubmission occurred.</p> <code>None</code> <code>attempt_job_name</code> <code>Optional[str]</code> <p>Job name used for this attempt (if regenerated).</p> <code>None</code> <code>attempt_script_path</code> <code>Optional[Union[str, Path]]</code> <p>Script path used for this attempt.</p> <code>None</code> <code>attempt_parameters</code> <code>Optional[Dict[str, Any]]</code> <p>Effective template parameters used for this attempt.</p> <code>None</code> <code>regenerated</code> <code>Optional[bool]</code> <p>Whether the script was regenerated for this attempt.</p> <code>None</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if job was found and resubmission recorded, False otherwise.</p> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def add_resubmission(\n    self,\n    job_name: str,\n    job_id: str,\n    extra_params: Optional[Dict[str, Any]] = None,\n    submission_group: Optional[str] = None,\n    hostname: Optional[str] = None,\n    attempt_job_name: Optional[str] = None,\n    attempt_script_path: Optional[Union[str, Path]] = None,\n    attempt_parameters: Optional[Dict[str, Any]] = None,\n    regenerated: Optional[bool] = None,\n) -&gt; bool:\n    \"\"\"\n    Record a job resubmission.\n\n    Args:\n        job_name: Name of the original job.\n        job_id: New SLURM job ID from resubmission.\n        extra_params: Additional parameters used for resubmission.\n        hostname: Hostname where resubmission occurred.\n        attempt_job_name: Job name used for this attempt (if regenerated).\n        attempt_script_path: Script path used for this attempt.\n        attempt_parameters: Effective template parameters used for this attempt.\n        regenerated: Whether the script was regenerated for this attempt.\n\n    Returns:\n        True if job was found and resubmission recorded, False otherwise.\n    \"\"\"\n    job = self.get_job(job_name)\n    if job is None:\n        return False\n\n    git_metadata = _get_git_metadata()\n    resubmission = {\n        \"job_id\": job_id,\n        \"state\": None,\n        \"hostname\": hostname or socket.gethostname(),\n        \"submitted_at\": datetime.now().isoformat(timespec=\"seconds\"),\n        \"extra_params\": extra_params or {},\n        \"submission_group\": submission_group,\n        \"job_name\": attempt_job_name,\n        \"script_path\": str(attempt_script_path) if attempt_script_path else None,\n        \"parameters\": attempt_parameters or {},\n        \"regenerated\": regenerated,\n        \"git_branch\": git_metadata[\"git_branch\"],\n        \"git_commit_id\": git_metadata[\"git_commit_id\"],\n    }\n\n    if \"resubmissions\" not in job:\n        job[\"resubmissions\"] = []\n\n    job[\"resubmissions\"].append(resubmission)\n    self._touch()\n\n    return True\n</code></pre>"},{"location":"api/collections/#slurmkit.collections.Collection.remove_job","title":"remove_job","text":"<pre><code>remove_job(job_name: str) -&gt; bool\n</code></pre> <p>Remove a job from the collection.</p> <p>Parameters:</p> Name Type Description Default <code>job_name</code> <code>str</code> <p>Name of the job to remove.</p> required <p>Returns:</p> Type Description <code>bool</code> <p>True if job was found and removed, False otherwise.</p> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def remove_job(self, job_name: str) -&gt; bool:\n    \"\"\"\n    Remove a job from the collection.\n\n    Args:\n        job_name: Name of the job to remove.\n\n    Returns:\n        True if job was found and removed, False otherwise.\n    \"\"\"\n    for i, job in enumerate(self._jobs):\n        if job[\"job_name\"] == job_name:\n            del self._jobs[i]\n            self._touch()\n            return True\n    return False\n</code></pre>"},{"location":"api/collections/#slurmkit.collections.Collection.filter_jobs","title":"filter_jobs","text":"<pre><code>filter_jobs(state: Optional[str] = None, hostname: Optional[str] = None, submitted: Optional[bool] = None) -&gt; List[Dict[str, Any]]\n</code></pre> <p>Filter jobs by criteria.</p> <p>Parameters:</p> Name Type Description Default <code>state</code> <code>Optional[str]</code> <p>Filter by normalized state (pending, running, completed, failed).</p> <code>None</code> <code>hostname</code> <code>Optional[str]</code> <p>Filter by hostname.</p> <code>None</code> <code>submitted</code> <code>Optional[bool]</code> <p>If True, only submitted jobs. If False, only unsubmitted.</p> <code>None</code> <p>Returns:</p> Type Description <code>List[Dict[str, Any]]</code> <p>List of matching job entries.</p> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def filter_jobs(\n    self,\n    state: Optional[str] = None,\n    hostname: Optional[str] = None,\n    submitted: Optional[bool] = None,\n) -&gt; List[Dict[str, Any]]:\n    \"\"\"\n    Filter jobs by criteria.\n\n    Args:\n        state: Filter by normalized state (pending, running, completed, failed).\n        hostname: Filter by hostname.\n        submitted: If True, only submitted jobs. If False, only unsubmitted.\n\n    Returns:\n        List of matching job entries.\n    \"\"\"\n    result = []\n\n    for job in self._jobs:\n        # Check submitted filter\n        if submitted is not None:\n            is_submitted = job.get(\"job_id\") is not None\n            if submitted != is_submitted:\n                continue\n\n        # Check hostname filter\n        if hostname is not None and job.get(\"hostname\") != hostname:\n            continue\n\n        # Check state filter\n        if state is not None:\n            job_state = self._normalize_state(job.get(\"state\"))\n            if job_state != state:\n                continue\n\n        result.append(job)\n\n    return result\n</code></pre>"},{"location":"api/collections/#slurmkit.collections.Collection.to_dict","title":"to_dict","text":"<pre><code>to_dict() -&gt; Dict[str, Any]\n</code></pre> <p>Convert collection to a dictionary.</p> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Dictionary representation of the collection.</p> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def to_dict(self) -&gt; Dict[str, Any]:\n    \"\"\"\n    Convert collection to a dictionary.\n\n    Returns:\n        Dictionary representation of the collection.\n    \"\"\"\n    return {\n        \"name\": self.name,\n        \"description\": self.description,\n        \"created_at\": self.created_at,\n        \"updated_at\": self.updated_at,\n        \"cluster\": self.cluster,\n        \"parameters\": self.parameters,\n        \"jobs\": self._jobs,\n        \"meta\": self.meta,\n    }\n</code></pre>"},{"location":"api/collections/#collectionmanager","title":"CollectionManager","text":""},{"location":"api/collections/#slurmkit.collections.CollectionManager","title":"CollectionManager","text":"<pre><code>CollectionManager(collections_dir: Optional[Union[str, Path]] = None, config: Optional[Config] = None)\n</code></pre> <p>Manager for loading, saving, and organizing collections.</p> <p>The manager handles persistence of collections to YAML files in a configurable directory.</p> <p>Attributes:</p> Name Type Description <code>collections_dir</code> <p>Directory where collection files are stored.</p> Example <p>manager = CollectionManager() collection = manager.get_or_create(\"my_experiment\") collection.add_job(...) manager.save(collection)</p> <p>Initialize the collection manager.</p> <p>Parameters:</p> Name Type Description Default <code>collections_dir</code> <code>Optional[Union[str, Path]]</code> <p>Directory for collection files. If None, uses config.</p> <code>None</code> <code>config</code> <code>Optional[Config]</code> <p>Configuration object. If None, uses global config.</p> <code>None</code> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def __init__(\n    self,\n    collections_dir: Optional[Union[str, Path]] = None,\n    config: Optional[Config] = None,\n):\n    \"\"\"\n    Initialize the collection manager.\n\n    Args:\n        collections_dir: Directory for collection files. If None, uses config.\n        config: Configuration object. If None, uses global config.\n    \"\"\"\n    if config is None:\n        config = get_config()\n\n    if collections_dir is not None:\n        self.collections_dir = Path(collections_dir)\n    else:\n        self.collections_dir = config.get_path(\"collections_dir\")\n        if self.collections_dir is None:\n            self.collections_dir = Path(\".job-collections\")\n</code></pre>"},{"location":"api/collections/#slurmkit.collections.CollectionManager.create","title":"create","text":"<pre><code>create(name: str, description: str = '', parameters: Optional[Dict[str, Any]] = None, overwrite: bool = False) -&gt; Collection\n</code></pre> <p>Create a new collection.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Collection name.</p> required <code>description</code> <code>str</code> <p>Human-readable description.</p> <code>''</code> <code>parameters</code> <code>Optional[Dict[str, Any]]</code> <p>Generation parameters specification.</p> <code>None</code> <code>overwrite</code> <code>bool</code> <p>If True, overwrite existing collection.</p> <code>False</code> <p>Returns:</p> Type Description <code>Collection</code> <p>New Collection object.</p> <p>Raises:</p> Type Description <code>FileExistsError</code> <p>If collection exists and overwrite=False.</p> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def create(\n    self,\n    name: str,\n    description: str = \"\",\n    parameters: Optional[Dict[str, Any]] = None,\n    overwrite: bool = False,\n) -&gt; Collection:\n    \"\"\"\n    Create a new collection.\n\n    Args:\n        name: Collection name.\n        description: Human-readable description.\n        parameters: Generation parameters specification.\n        overwrite: If True, overwrite existing collection.\n\n    Returns:\n        New Collection object.\n\n    Raises:\n        FileExistsError: If collection exists and overwrite=False.\n    \"\"\"\n    if self.exists(name) and not overwrite:\n        raise FileExistsError(\n            f\"Collection already exists: {name}. Use overwrite=True to replace.\"\n        )\n\n    collection = Collection(\n        name=name,\n        description=description,\n        parameters=parameters,\n    )\n\n    self.save(collection)\n    return collection\n</code></pre>"},{"location":"api/collections/#slurmkit.collections.CollectionManager.exists","title":"exists","text":"<pre><code>exists(name: str) -&gt; bool\n</code></pre> <p>Check if a collection exists.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Collection name.</p> required <p>Returns:</p> Type Description <code>bool</code> <p>True if collection file exists.</p> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def exists(self, name: str) -&gt; bool:\n    \"\"\"\n    Check if a collection exists.\n\n    Args:\n        name: Collection name.\n\n    Returns:\n        True if collection file exists.\n    \"\"\"\n    return self._get_path(name).exists()\n</code></pre>"},{"location":"api/collections/#slurmkit.collections.CollectionManager.delete","title":"delete","text":"<pre><code>delete(name: str) -&gt; bool\n</code></pre> <p>Delete a collection.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Collection name.</p> required <p>Returns:</p> Type Description <code>bool</code> <p>True if collection was deleted, False if it didn't exist.</p> Source code in <code>src/slurmkit/collections.py</code> <pre><code>def delete(self, name: str) -&gt; bool:\n    \"\"\"\n    Delete a collection.\n\n    Args:\n        name: Collection name.\n\n    Returns:\n        True if collection was deleted, False if it didn't exist.\n    \"\"\"\n    path = self._get_path(name)\n\n    if path.exists():\n        path.unlink()\n        return True\n    return False\n</code></pre>"},{"location":"api/collections/#usage-example","title":"Usage Example","text":"<pre><code>from slurmkit import Collection, CollectionManager\n\n# Create a collection manager\nmanager = CollectionManager()\n\n# Create a new collection\ncollection = manager.create(\"my_experiment\", description=\"Training sweep\")\n\n# Add a job to the collection\ncollection.add_job(\n    name=\"lr0.01_bs32\",\n    params={\"learning_rate\": 0.01, \"batch_size\": 32},\n    script_path=\"jobs/exp1/job_scripts/lr0.01_bs32.sh\"\n)\n\n# Submit and record job ID\ncollection.update_job(\"lr0.01_bs32\", job_id=\"12345\", state=\"PENDING\")\n\n# Filter jobs by state\nfailed_jobs = collection.filter_jobs(state=\"FAILED\")\n\n# Save collection\ncollection.save()\n</code></pre>"},{"location":"api/config/","title":"Config","text":"<p>Configuration management for slurmkit projects.</p>"},{"location":"api/config/#overview","title":"Overview","text":"<p>The <code>Config</code> class manages configuration from multiple sources with the following priority (highest to lowest):</p> <ol> <li>CLI arguments</li> <li>Environment variables (<code>SLURMKIT_*</code>)</li> <li>Config file (<code>.slurm-kit/config.yaml</code>)</li> <li>Default values</li> </ol>"},{"location":"api/config/#classes","title":"Classes","text":""},{"location":"api/config/#slurmkit.config.Config","title":"Config","text":"<pre><code>Config(config_path: Optional[Union[str, Path]] = None, project_root: Optional[Union[str, Path]] = None)\n</code></pre> <p>Configuration manager for slurmkit.</p> <p>Loads configuration from multiple sources and provides access to settings. Configuration precedence (highest to lowest): 1. Explicit overrides (passed to methods) 2. Environment variables 3. Project config file 4. Built-in defaults</p> <p>Attributes:</p> Name Type Description <code>config_path</code> <p>Path to the loaded config file (if any)</p> <code>project_root</code> <p>Root directory of the project (where .slurm-kit/ lives)</p> <code>hostname</code> <p>Current machine's hostname (for cluster identification)</p> Example <p>config = Config() config.get(\"jobs_dir\") 'jobs/' config.get(\"slurm_defaults.partition\") 'compute'</p> <p>Initialize configuration.</p> <p>Parameters:</p> Name Type Description Default <code>config_path</code> <code>Optional[Union[str, Path]]</code> <p>Explicit path to config file. If None, searches for .slurm-kit/config.yaml in project_root or current directory.</p> <code>None</code> <code>project_root</code> <code>Optional[Union[str, Path]]</code> <p>Project root directory. If None, uses current directory.</p> <code>None</code> Source code in <code>src/slurmkit/config.py</code> <pre><code>def __init__(\n    self,\n    config_path: Optional[Union[str, Path]] = None,\n    project_root: Optional[Union[str, Path]] = None,\n):\n    \"\"\"\n    Initialize configuration.\n\n    Args:\n        config_path: Explicit path to config file. If None, searches for\n            .slurm-kit/config.yaml in project_root or current directory.\n        project_root: Project root directory. If None, uses current directory.\n    \"\"\"\n    self.hostname = socket.gethostname()\n    self.project_root = Path(project_root) if project_root else Path.cwd()\n\n    # Determine config file path\n    if config_path:\n        self.config_path = Path(config_path)\n    else:\n        # Check environment variable first\n        env_config = os.environ.get(\"SLURMKIT_CONFIG\")\n        if env_config:\n            self.config_path = Path(env_config)\n        else:\n            self.config_path = self.project_root / \".slurm-kit\" / \"config.yaml\"\n\n    # Load configuration\n    self._config = self._load_config()\n</code></pre>"},{"location":"api/config/#slurmkit.config.Config.get","title":"get","text":"<pre><code>get(key: str, default: Any = None) -&gt; Any\n</code></pre> <p>Get a configuration value by dot-separated key path.</p> <p>Parameters:</p> Name Type Description Default <code>key</code> <code>str</code> <p>Dot-separated key path (e.g., \"slurm_defaults.partition\")</p> required <code>default</code> <code>Any</code> <p>Default value if key not found.</p> <code>None</code> <p>Returns:</p> Type Description <code>Any</code> <p>Configuration value or default.</p> Example <p>config.get(\"jobs_dir\") 'jobs/' config.get(\"slurm_defaults.partition\") 'compute' config.get(\"nonexistent\", \"fallback\") 'fallback'</p> Source code in <code>src/slurmkit/config.py</code> <pre><code>def get(self, key: str, default: Any = None) -&gt; Any:\n    \"\"\"\n    Get a configuration value by dot-separated key path.\n\n    Args:\n        key: Dot-separated key path (e.g., \"slurm_defaults.partition\")\n        default: Default value if key not found.\n\n    Returns:\n        Configuration value or default.\n\n    Example:\n        &gt;&gt;&gt; config.get(\"jobs_dir\")\n        'jobs/'\n        &gt;&gt;&gt; config.get(\"slurm_defaults.partition\")\n        'compute'\n        &gt;&gt;&gt; config.get(\"nonexistent\", \"fallback\")\n        'fallback'\n    \"\"\"\n    return _get_nested(self._config, key, default)\n</code></pre>"},{"location":"api/config/#slurmkit.config.Config.get_path","title":"get_path","text":"<pre><code>get_path(key: str, default: Any = None) -&gt; Optional[Path]\n</code></pre> <p>Get a configuration value as a Path, resolved relative to project root.</p> <p>Parameters:</p> Name Type Description Default <code>key</code> <code>str</code> <p>Dot-separated key path.</p> required <code>default</code> <code>Any</code> <p>Default value if key not found.</p> <code>None</code> <p>Returns:</p> Type Description <code>Optional[Path]</code> <p>Resolved Path or None.</p> Source code in <code>src/slurmkit/config.py</code> <pre><code>def get_path(self, key: str, default: Any = None) -&gt; Optional[Path]:\n    \"\"\"\n    Get a configuration value as a Path, resolved relative to project root.\n\n    Args:\n        key: Dot-separated key path.\n        default: Default value if key not found.\n\n    Returns:\n        Resolved Path or None.\n    \"\"\"\n    value = self.get(key, default)\n    if value is None:\n        return None\n    path = Path(value)\n    if not path.is_absolute():\n        path = self.project_root / path\n    return path\n</code></pre>"},{"location":"api/config/#slurmkit.config.Config.get_output_patterns","title":"get_output_patterns","text":"<pre><code>get_output_patterns() -&gt; List[str]\n</code></pre> <p>Get output file patterns in priority order.</p> <p>Returns:</p> Type Description <code>List[str]</code> <p>List of output file pattern strings.</p> Source code in <code>src/slurmkit/config.py</code> <pre><code>def get_output_patterns(self) -&gt; List[str]:\n    \"\"\"\n    Get output file patterns in priority order.\n\n    Returns:\n        List of output file pattern strings.\n    \"\"\"\n    patterns = self.get(\"output_patterns\", DEFAULT_CONFIG[\"output_patterns\"])\n    if isinstance(patterns, str):\n        patterns = [patterns]\n    return patterns\n</code></pre>"},{"location":"api/config/#slurmkit.config.Config.get_slurm_defaults","title":"get_slurm_defaults","text":"<pre><code>get_slurm_defaults() -&gt; Dict[str, Any]\n</code></pre> <p>Get default SLURM arguments.</p> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Dictionary of default SLURM arguments.</p> Source code in <code>src/slurmkit/config.py</code> <pre><code>def get_slurm_defaults(self) -&gt; Dict[str, Any]:\n    \"\"\"\n    Get default SLURM arguments.\n\n    Returns:\n        Dictionary of default SLURM arguments.\n    \"\"\"\n    return self.get(\"slurm_defaults\", DEFAULT_CONFIG[\"slurm_defaults\"])\n</code></pre>"},{"location":"api/config/#slurmkit.config.Config.as_dict","title":"as_dict","text":"<pre><code>as_dict() -&gt; Dict[str, Any]\n</code></pre> <p>Return the full configuration as a dictionary.</p> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Complete configuration dictionary.</p> Source code in <code>src/slurmkit/config.py</code> <pre><code>def as_dict(self) -&gt; Dict[str, Any]:\n    \"\"\"\n    Return the full configuration as a dictionary.\n\n    Returns:\n        Complete configuration dictionary.\n    \"\"\"\n    return _deep_copy(self._config)\n</code></pre>"},{"location":"api/config/#slurmkit.config.Config.save","title":"save","text":"<pre><code>save(path: Optional[Union[str, Path]] = None) -&gt; Path\n</code></pre> <p>Save current configuration to a YAML file.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>Optional[Union[str, Path]]</code> <p>Path to save to. Defaults to self.config_path.</p> <code>None</code> <p>Returns:</p> Type Description <code>Path</code> <p>Path where config was saved.</p> Source code in <code>src/slurmkit/config.py</code> <pre><code>def save(self, path: Optional[Union[str, Path]] = None) -&gt; Path:\n    \"\"\"\n    Save current configuration to a YAML file.\n\n    Args:\n        path: Path to save to. Defaults to self.config_path.\n\n    Returns:\n        Path where config was saved.\n    \"\"\"\n    save_path = Path(path) if path else self.config_path\n    save_path.parent.mkdir(parents=True, exist_ok=True)\n\n    with open(save_path, \"w\") as f:\n        yaml.dump(self._config, f, default_flow_style=False, sort_keys=False)\n\n    return save_path\n</code></pre>"},{"location":"api/config/#functions","title":"Functions","text":""},{"location":"api/config/#slurmkit.config.get_config","title":"get_config","text":"<pre><code>get_config(config_path: Optional[Union[str, Path]] = None, project_root: Optional[Union[str, Path]] = None, reload: bool = False) -&gt; Config\n</code></pre> <p>Get the global configuration instance.</p> <p>This function provides a singleton-like access to configuration. On first call (or when reload=True), it creates a new Config instance.</p> <p>Parameters:</p> Name Type Description Default <code>config_path</code> <code>Optional[Union[str, Path]]</code> <p>Explicit path to config file.</p> <code>None</code> <code>project_root</code> <code>Optional[Union[str, Path]]</code> <p>Project root directory.</p> <code>None</code> <code>reload</code> <code>bool</code> <p>Force reload of configuration.</p> <code>False</code> <p>Returns:</p> Type Description <code>Config</code> <p>Global Config instance.</p> Example <p>config = get_config() config.get(\"jobs_dir\") 'jobs/'</p> Source code in <code>src/slurmkit/config.py</code> <pre><code>def get_config(\n    config_path: Optional[Union[str, Path]] = None,\n    project_root: Optional[Union[str, Path]] = None,\n    reload: bool = False,\n) -&gt; Config:\n    \"\"\"\n    Get the global configuration instance.\n\n    This function provides a singleton-like access to configuration.\n    On first call (or when reload=True), it creates a new Config instance.\n\n    Args:\n        config_path: Explicit path to config file.\n        project_root: Project root directory.\n        reload: Force reload of configuration.\n\n    Returns:\n        Global Config instance.\n\n    Example:\n        &gt;&gt;&gt; config = get_config()\n        &gt;&gt;&gt; config.get(\"jobs_dir\")\n        'jobs/'\n    \"\"\"\n    global _global_config\n\n    if _global_config is None or reload:\n        _global_config = Config(config_path=config_path, project_root=project_root)\n\n    return _global_config\n</code></pre>"},{"location":"api/config/#slurmkit.config.init_config","title":"init_config","text":"<pre><code>init_config(project_root: Optional[Union[str, Path]] = None, overwrite: bool = False, **kwargs: Any) -&gt; Path\n</code></pre> <p>Initialize a new project configuration file.</p> <p>Creates .slurm-kit/config.yaml with default values, optionally customized with provided kwargs.</p> <p>Parameters:</p> Name Type Description Default <code>project_root</code> <code>Optional[Union[str, Path]]</code> <p>Project root directory. Defaults to current directory.</p> <code>None</code> <code>overwrite</code> <code>bool</code> <p>If True, overwrite existing config file.</p> <code>False</code> <code>**kwargs</code> <code>Any</code> <p>Configuration values to set (e.g., jobs_dir=\"my_jobs/\").</p> <code>{}</code> <p>Returns:</p> Type Description <code>Path</code> <p>Path to created config file.</p> <p>Raises:</p> Type Description <code>FileExistsError</code> <p>If config file exists and overwrite=False.</p> Example <p>init_config(jobs_dir=\"experiments/\", slurm_defaults={\"partition\": \"gpu\"}) PosixPath('.slurm-kit/config.yaml')</p> Source code in <code>src/slurmkit/config.py</code> <pre><code>def init_config(\n    project_root: Optional[Union[str, Path]] = None,\n    overwrite: bool = False,\n    **kwargs: Any,\n) -&gt; Path:\n    \"\"\"\n    Initialize a new project configuration file.\n\n    Creates .slurm-kit/config.yaml with default values, optionally\n    customized with provided kwargs.\n\n    Args:\n        project_root: Project root directory. Defaults to current directory.\n        overwrite: If True, overwrite existing config file.\n        **kwargs: Configuration values to set (e.g., jobs_dir=\"my_jobs/\").\n\n    Returns:\n        Path to created config file.\n\n    Raises:\n        FileExistsError: If config file exists and overwrite=False.\n\n    Example:\n        &gt;&gt;&gt; init_config(jobs_dir=\"experiments/\", slurm_defaults={\"partition\": \"gpu\"})\n        PosixPath('.slurm-kit/config.yaml')\n    \"\"\"\n    root = Path(project_root) if project_root else Path.cwd()\n    config_path = root / \".slurm-kit\" / \"config.yaml\"\n\n    if config_path.exists() and not overwrite:\n        raise FileExistsError(\n            f\"Config file already exists: {config_path}. \"\n            \"Use overwrite=True to replace.\"\n        )\n\n    # Start with defaults and apply any overrides\n    config_data = _deep_copy(DEFAULT_CONFIG)\n    for key, value in kwargs.items():\n        if isinstance(value, dict) and key in config_data:\n            config_data[key] = _deep_merge(config_data[key], value)\n        else:\n            config_data[key] = value\n\n    # Create directory and write config\n    config_path.parent.mkdir(parents=True, exist_ok=True)\n    with open(config_path, \"w\") as f:\n        yaml.dump(config_data, f, default_flow_style=False, sort_keys=False)\n\n    return config_path\n</code></pre>"},{"location":"api/config/#usage-example","title":"Usage Example","text":"<pre><code>from slurmkit import Config, get_config\n\n# Get the global config instance\nconfig = get_config()\n\n# Access configuration values\njobs_dir = config.get(\"jobs_dir\")\npartition = config.get(\"slurm_defaults.partition\")\n\n# Get as Path object\njobs_path = config.get_path(\"jobs_dir\")\n\n# Get all SLURM defaults\nslurm_defaults = config.get_slurm_defaults()\n</code></pre>"},{"location":"api/generate/","title":"Job Generation","text":"<p>Template-based SLURM job script generation with parameter sweeps.</p>"},{"location":"api/generate/#overview","title":"Overview","text":"<p>The <code>JobGenerator</code> class generates SLURM job scripts from Jinja2 templates combined with parameter specifications. It supports:</p> <ul> <li>Grid-based parameter sweeps</li> <li>Explicit parameter lists</li> <li>Dynamic SLURM argument computation via Python functions</li> <li>Custom job naming patterns</li> </ul>"},{"location":"api/generate/#classes","title":"Classes","text":""},{"location":"api/generate/#jobgenerator","title":"JobGenerator","text":""},{"location":"api/generate/#slurmkit.generate.JobGenerator","title":"JobGenerator","text":"<pre><code>JobGenerator(template_path: Union[str, Path], parameters: Dict[str, Any], slurm_defaults: Optional[Dict[str, Any]] = None, slurm_logic_file: Optional[Union[str, Path]] = None, slurm_logic_function: str = 'get_slurm_args', job_name_pattern: Optional[str] = None, logs_dir: Optional[Union[str, Path]] = None, config: Optional[Config] = None)\n</code></pre> <p>Generator for SLURM job scripts from templates and parameters.</p> <p>The generator combines: - Jinja2 templates for job script structure - Parameter grids or lists for job variations - Optional Python logic for SLURM argument customization - Collection integration for tracking generated jobs</p> Example <p>generator = JobGenerator( ...     template_path=\"templates/train.job.j2\", ...     parameters={\"mode\": \"grid\", \"values\": {\"lr\": [0.01, 0.1]}}, ...     slurm_defaults={\"partition\": \"gpu\", \"time\": \"24:00:00\"}, ... ) scripts = generator.generate(output_dir=\"jobs/exp1/scripts\")</p> <p>Initialize the job generator.</p> <p>Parameters:</p> Name Type Description Default <code>template_path</code> <code>Union[str, Path]</code> <p>Path to the Jinja2 template file.</p> required <code>parameters</code> <code>Dict[str, Any]</code> <p>Parameter specification (mode + values).</p> required <code>slurm_defaults</code> <code>Optional[Dict[str, Any]]</code> <p>Default SLURM arguments.</p> <code>None</code> <code>slurm_logic_file</code> <code>Optional[Union[str, Path]]</code> <p>Path to Python file with SLURM args function.</p> <code>None</code> <code>slurm_logic_function</code> <code>str</code> <p>Name of the function in slurm_logic_file.</p> <code>'get_slurm_args'</code> <code>job_name_pattern</code> <code>Optional[str]</code> <p>Jinja2 pattern for job names.</p> <code>None</code> <code>logs_dir</code> <code>Optional[Union[str, Path]]</code> <p>Directory for job output files (used in templates).</p> <code>None</code> <code>config</code> <code>Optional[Config]</code> <p>Configuration object.</p> <code>None</code> Source code in <code>src/slurmkit/generate.py</code> <pre><code>def __init__(\n    self,\n    template_path: Union[str, Path],\n    parameters: Dict[str, Any],\n    slurm_defaults: Optional[Dict[str, Any]] = None,\n    slurm_logic_file: Optional[Union[str, Path]] = None,\n    slurm_logic_function: str = \"get_slurm_args\",\n    job_name_pattern: Optional[str] = None,\n    logs_dir: Optional[Union[str, Path]] = None,\n    config: Optional[Config] = None,\n):\n    \"\"\"\n    Initialize the job generator.\n\n    Args:\n        template_path: Path to the Jinja2 template file.\n        parameters: Parameter specification (mode + values).\n        slurm_defaults: Default SLURM arguments.\n        slurm_logic_file: Path to Python file with SLURM args function.\n        slurm_logic_function: Name of the function in slurm_logic_file.\n        job_name_pattern: Jinja2 pattern for job names.\n        logs_dir: Directory for job output files (used in templates).\n        config: Configuration object.\n    \"\"\"\n    if config is None:\n        config = get_config()\n\n    self.config = config\n    self.template_path = Path(template_path)\n    self.parameters = parameters\n    self.job_name_pattern = job_name_pattern\n    self.logs_dir = Path(logs_dir) if logs_dir else None\n    self.slurm_logic_file = Path(slurm_logic_file) if slurm_logic_file else None\n    self.slurm_logic_function = slurm_logic_function\n\n    # Parameter filter logic (optional)\n    self.param_filter_func = None\n    if isinstance(self.parameters, dict) and self.parameters.get(\"mode\", \"grid\") == \"grid\":\n        filter_spec = self.parameters.get(\"filter\")\n        if callable(filter_spec):\n            self.param_filter_func = filter_spec\n        elif isinstance(filter_spec, dict):\n            filter_file = filter_spec.get(\"file\", \"\")\n            if filter_file:\n                self.param_filter_func = load_param_filter_function(\n                    filter_file,\n                    filter_spec.get(\"function\", \"include_params\"),\n                )\n\n    # SLURM arguments - merge config defaults with job spec defaults\n    # Config defaults provide the base, job spec defaults override\n    self.slurm_defaults = config.get_slurm_defaults().copy()\n    if slurm_defaults:\n        self.slurm_defaults.update(slurm_defaults)\n    self.slurm_logic_func = None\n\n    if self.slurm_logic_file:\n        self.slurm_logic_func = load_slurm_args_function(\n            self.slurm_logic_file,\n            self.slurm_logic_function,\n        )\n\n    # Set up Jinja2 environment\n    template_dir = self.template_path.parent\n    self._env = Environment(\n        loader=FileSystemLoader(str(template_dir)),\n        keep_trailing_newline=True,\n    )\n</code></pre>"},{"location":"api/generate/#slurmkit.generate.JobGenerator.from_spec","title":"from_spec  <code>classmethod</code>","text":"<pre><code>from_spec(spec_path: Union[str, Path], config: Optional[Config] = None) -&gt; 'JobGenerator'\n</code></pre> <p>Create a generator from a job spec file.</p> <p>Parameters:</p> Name Type Description Default <code>spec_path</code> <code>Union[str, Path]</code> <p>Path to the job spec YAML file.</p> required <code>config</code> <code>Optional[Config]</code> <p>Configuration object.</p> <code>None</code> <p>Returns:</p> Type Description <code>'JobGenerator'</code> <p>Configured JobGenerator instance.</p> Source code in <code>src/slurmkit/generate.py</code> <pre><code>@classmethod\ndef from_spec(\n    cls,\n    spec_path: Union[str, Path],\n    config: Optional[Config] = None,\n) -&gt; \"JobGenerator\":\n    \"\"\"\n    Create a generator from a job spec file.\n\n    Args:\n        spec_path: Path to the job spec YAML file.\n        config: Configuration object.\n\n    Returns:\n        Configured JobGenerator instance.\n    \"\"\"\n    spec_path = Path(spec_path)\n    spec = load_job_spec(spec_path)\n\n    # Resolve paths relative to spec file\n    spec_dir = spec_path.parent\n\n    template_path = spec.get(\"template\", \"\")\n    if not Path(template_path).is_absolute():\n        template_path = spec_dir / template_path\n\n    parameters = resolve_parameters_filter_spec(\n        spec.get(\"parameters\", {}),\n        base_dir=spec_dir,\n    )\n\n    slurm_logic_file = None\n    slurm_logic_function = \"get_slurm_args\"\n    slurm_args = spec.get(\"slurm_args\", {})\n\n    if \"logic\" in slurm_args:\n        logic_spec = slurm_args[\"logic\"]\n        logic_file = logic_spec.get(\"file\", \"\")\n        if logic_file:\n            if not Path(logic_file).is_absolute():\n                slurm_logic_file = spec_dir / logic_file\n            else:\n                slurm_logic_file = Path(logic_file)\n        slurm_logic_function = logic_spec.get(\"function\", \"get_slurm_args\")\n\n    logs_dir = spec.get(\"logs_dir\")\n    if logs_dir and not Path(logs_dir).is_absolute():\n        logs_dir = spec_dir / logs_dir\n\n    return cls(\n        template_path=template_path,\n        parameters=parameters,\n        slurm_defaults=slurm_args.get(\"defaults\"),\n        slurm_logic_file=slurm_logic_file,\n        slurm_logic_function=slurm_logic_function,\n        job_name_pattern=spec.get(\"job_name_pattern\"),\n        logs_dir=logs_dir,\n        config=config,\n    )\n</code></pre>"},{"location":"api/generate/#slurmkit.generate.JobGenerator.generate","title":"generate","text":"<pre><code>generate(output_dir: Union[str, Path], collection: Optional[Collection] = None, dry_run: bool = False) -&gt; List[Dict[str, Any]]\n</code></pre> <p>Generate job scripts.</p> <p>Parameters:</p> Name Type Description Default <code>output_dir</code> <code>Union[str, Path]</code> <p>Directory to write generated scripts.</p> required <code>collection</code> <code>Optional[Collection]</code> <p>Collection to add generated jobs to.</p> <code>None</code> <code>dry_run</code> <code>bool</code> <p>If True, don't write files, just return what would be generated.</p> <code>False</code> <p>Returns:</p> Type Description <code>List[Dict[str, Any]]</code> <p>List of generated job info dicts with keys:</p> <code>List[Dict[str, Any]]</code> <ul> <li>job_name: Generated job name</li> </ul> <code>List[Dict[str, Any]]</code> <ul> <li>script_path: Path to the script file</li> </ul> <code>List[Dict[str, Any]]</code> <ul> <li>parameters: Job parameters</li> </ul> <code>List[Dict[str, Any]]</code> <ul> <li>slurm_args: Computed SLURM arguments</li> </ul> Source code in <code>src/slurmkit/generate.py</code> <pre><code>def generate(\n    self,\n    output_dir: Union[str, Path],\n    collection: Optional[Collection] = None,\n    dry_run: bool = False,\n) -&gt; List[Dict[str, Any]]:\n    \"\"\"\n    Generate job scripts.\n\n    Args:\n        output_dir: Directory to write generated scripts.\n        collection: Collection to add generated jobs to.\n        dry_run: If True, don't write files, just return what would be generated.\n\n    Returns:\n        List of generated job info dicts with keys:\n        - job_name: Generated job name\n        - script_path: Path to the script file\n        - parameters: Job parameters\n        - slurm_args: Computed SLURM arguments\n    \"\"\"\n    output_dir = Path(output_dir)\n\n    if not dry_run:\n        output_dir.mkdir(parents=True, exist_ok=True)\n\n    # Expand parameters\n    param_list = expand_parameters(\n        self.parameters,\n        filter_func=self.param_filter_func,\n    )\n\n    generated = []\n\n    for params in param_list:\n        # Generate job name\n        job_name = generate_job_name(\n            params,\n            pattern=self.job_name_pattern,\n            env=self._env,\n        )\n\n        job_info = self.generate_one(\n            output_dir=output_dir,\n            params=params,\n            job_name=job_name,\n            dry_run=dry_run,\n        )\n\n        generated.append(job_info)\n\n        # Add to collection if provided\n        if collection is not None:\n            collection.add_job(\n                job_name=job_name,\n                script_path=job_info[\"script_path\"],\n                parameters=params,\n            )\n\n    return generated\n</code></pre>"},{"location":"api/generate/#functions","title":"Functions","text":""},{"location":"api/generate/#slurmkit.generate.expand_grid","title":"expand_grid","text":"<pre><code>expand_grid(params: Dict[str, List[Any]], filter_func: Optional[Callable[[Dict[str, Any]], bool]] = None) -&gt; Iterator[Dict[str, Any]]\n</code></pre> <p>Expand a parameter grid into all combinations.</p> <p>Takes a dictionary where values are lists and yields all combinations as individual dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>params</code> <code>Dict[str, List[Any]]</code> <p>Dictionary mapping parameter names to lists of values.</p> required <code>filter_func</code> <code>Optional[Callable[[Dict[str, Any]], bool]]</code> <p>Optional predicate to include/exclude combinations. If provided, only combinations where filter_func(params) is True are yielded.</p> <code>None</code> <p>Yields:</p> Type Description <code>Dict[str, Any]</code> <p>Dictionary for each combination of parameter values.</p> Example <p>list(expand_grid({\"a\": [1, 2], \"b\": [\"x\", \"y\"]})) [{'a': 1, 'b': 'x'}, {'a': 1, 'b': 'y'}, {'a': 2, 'b': 'x'}, {'a': 2, 'b': 'y'}]</p> Source code in <code>src/slurmkit/generate.py</code> <pre><code>def expand_grid(\n    params: Dict[str, List[Any]],\n    filter_func: Optional[Callable[[Dict[str, Any]], bool]] = None,\n) -&gt; Iterator[Dict[str, Any]]:\n    \"\"\"\n    Expand a parameter grid into all combinations.\n\n    Takes a dictionary where values are lists and yields all\n    combinations as individual dictionaries.\n\n    Args:\n        params: Dictionary mapping parameter names to lists of values.\n        filter_func: Optional predicate to include/exclude combinations.\n            If provided, only combinations where filter_func(params) is True\n            are yielded.\n\n    Yields:\n        Dictionary for each combination of parameter values.\n\n    Example:\n        &gt;&gt;&gt; list(expand_grid({\"a\": [1, 2], \"b\": [\"x\", \"y\"]}))\n        [{'a': 1, 'b': 'x'}, {'a': 1, 'b': 'y'}, {'a': 2, 'b': 'x'}, {'a': 2, 'b': 'y'}]\n    \"\"\"\n    if not params:\n        yield {}\n        return\n\n    keys = list(params.keys())\n    values = [params[k] if isinstance(params[k], list) else [params[k]] for k in keys]\n\n    for combo in itertools.product(*values):\n        combo_dict = dict(zip(keys, combo))\n        if filter_func is not None and not filter_func(combo_dict):\n            continue\n        yield combo_dict\n</code></pre>"},{"location":"api/generate/#slurmkit.generate.expand_parameters","title":"expand_parameters","text":"<pre><code>expand_parameters(spec: Dict[str, Any], filter_func: Optional[Callable[[Dict[str, Any]], bool]] = None) -&gt; List[Dict[str, Any]]\n</code></pre> <p>Expand a parameter specification into a list of parameter dicts.</p> <p>Supports two modes: - \"grid\": All combinations of parameter values - \"list\": Explicit list of parameter dictionaries</p> <p>Parameters:</p> Name Type Description Default <code>spec</code> <code>Dict[str, Any]</code> <p>Parameter specification with \"mode\" and \"values\" keys. mode: \"grid\" or \"list\" values: For grid mode, dict of param_name -&gt; list of values.         For list mode, list of param dicts.</p> required <code>filter_func</code> <code>Optional[Callable[[Dict[str, Any]], bool]]</code> <p>Optional predicate for grid mode to include/exclude combinations.</p> <code>None</code> <p>Returns:</p> Type Description <code>List[Dict[str, Any]]</code> <p>List of parameter dictionaries.</p> Example <p>spec = {\"mode\": \"grid\", \"values\": {\"lr\": [0.01, 0.1], \"bs\": [32]}} expand_parameters(spec) [{'lr': 0.01, 'bs': 32}, {'lr': 0.1, 'bs': 32}]</p> <p>spec = {\"mode\": \"list\", \"values\": [{\"lr\": 0.01}, {\"lr\": 0.1}]} expand_parameters(spec) [{'lr': 0.01}, {'lr': 0.1}]</p> Source code in <code>src/slurmkit/generate.py</code> <pre><code>def expand_parameters(\n    spec: Dict[str, Any],\n    filter_func: Optional[Callable[[Dict[str, Any]], bool]] = None,\n) -&gt; List[Dict[str, Any]]:\n    \"\"\"\n    Expand a parameter specification into a list of parameter dicts.\n\n    Supports two modes:\n    - \"grid\": All combinations of parameter values\n    - \"list\": Explicit list of parameter dictionaries\n\n    Args:\n        spec: Parameter specification with \"mode\" and \"values\" keys.\n            mode: \"grid\" or \"list\"\n            values: For grid mode, dict of param_name -&gt; list of values.\n                    For list mode, list of param dicts.\n        filter_func: Optional predicate for grid mode to include/exclude\n            combinations.\n\n    Returns:\n        List of parameter dictionaries.\n\n    Example:\n        &gt;&gt;&gt; spec = {\"mode\": \"grid\", \"values\": {\"lr\": [0.01, 0.1], \"bs\": [32]}}\n        &gt;&gt;&gt; expand_parameters(spec)\n        [{'lr': 0.01, 'bs': 32}, {'lr': 0.1, 'bs': 32}]\n\n        &gt;&gt;&gt; spec = {\"mode\": \"list\", \"values\": [{\"lr\": 0.01}, {\"lr\": 0.1}]}\n        &gt;&gt;&gt; expand_parameters(spec)\n        [{'lr': 0.01}, {'lr': 0.1}]\n    \"\"\"\n    mode = spec.get(\"mode\", \"grid\")\n    values = spec.get(\"values\", {})\n\n    if mode == \"list\":\n        if isinstance(values, list):\n            return values\n        else:\n            return [values]\n\n    elif mode == \"grid\":\n        if filter_func is None:\n            filter_spec = spec.get(\"filter\")\n            if callable(filter_spec):\n                filter_func = filter_spec\n            elif isinstance(filter_spec, dict):\n                filter_file = filter_spec.get(\"file\", \"\")\n                if filter_file:\n                    filter_func = load_param_filter_function(\n                        filter_file,\n                        filter_spec.get(\"function\", \"include_params\"),\n                    )\n        return list(expand_grid(values, filter_func=filter_func))\n\n    else:\n        raise ValueError(f\"Unknown parameter mode: {mode}. Use 'grid' or 'list'.\")\n</code></pre>"},{"location":"api/generate/#slurmkit.generate.load_job_spec","title":"load_job_spec","text":"<pre><code>load_job_spec(spec_path: Union[str, Path]) -&gt; Dict[str, Any]\n</code></pre> <p>Load a job specification from a YAML file.</p> <p>Parameters:</p> Name Type Description Default <code>spec_path</code> <code>Union[str, Path]</code> <p>Path to the job spec YAML file.</p> required <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Parsed job specification dictionary.</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If the file doesn't exist.</p> Source code in <code>src/slurmkit/generate.py</code> <pre><code>def load_job_spec(spec_path: Union[str, Path]) -&gt; Dict[str, Any]:\n    \"\"\"\n    Load a job specification from a YAML file.\n\n    Args:\n        spec_path: Path to the job spec YAML file.\n\n    Returns:\n        Parsed job specification dictionary.\n\n    Raises:\n        FileNotFoundError: If the file doesn't exist.\n    \"\"\"\n    spec_path = Path(spec_path)\n\n    if not spec_path.exists():\n        raise FileNotFoundError(f\"Job spec not found: {spec_path}\")\n\n    with open(spec_path, \"r\") as f:\n        spec = yaml.safe_load(f) or {}\n\n    return spec\n</code></pre>"},{"location":"api/generate/#slurmkit.generate.generate_job_name","title":"generate_job_name","text":"<pre><code>generate_job_name(params: Dict[str, Any], pattern: Optional[str] = None, env: Optional[Environment] = None) -&gt; str\n</code></pre> <p>Generate a job name from parameters.</p> <p>Uses a Jinja2 pattern to format the job name from parameter values.</p> <p>Parameters:</p> Name Type Description Default <code>params</code> <code>Dict[str, Any]</code> <p>Job parameters.</p> required <code>pattern</code> <code>Optional[str]</code> <p>Jinja2 pattern for job name. If None, uses param values joined by underscores.</p> <code>None</code> <code>env</code> <code>Optional[Environment]</code> <p>Jinja2 environment. If None, creates a new one.</p> <code>None</code> <p>Returns:</p> Type Description <code>str</code> <p>Generated job name.</p> Example <p>generate_job_name({\"model\": \"resnet\", \"lr\": 0.01}, \"{{ model }}_lr{{ lr }}\") 'resnet_lr0.01'</p> Source code in <code>src/slurmkit/generate.py</code> <pre><code>def generate_job_name(\n    params: Dict[str, Any],\n    pattern: Optional[str] = None,\n    env: Optional[Environment] = None,\n) -&gt; str:\n    \"\"\"\n    Generate a job name from parameters.\n\n    Uses a Jinja2 pattern to format the job name from parameter values.\n\n    Args:\n        params: Job parameters.\n        pattern: Jinja2 pattern for job name. If None, uses param values joined by underscores.\n        env: Jinja2 environment. If None, creates a new one.\n\n    Returns:\n        Generated job name.\n\n    Example:\n        &gt;&gt;&gt; generate_job_name({\"model\": \"resnet\", \"lr\": 0.01}, \"{{ model }}_lr{{ lr }}\")\n        'resnet_lr0.01'\n    \"\"\"\n    if pattern is None:\n        # Default: join param values with underscores\n        parts = [f\"{k}{v}\" for k, v in sorted(params.items())]\n        return \"_\".join(parts)\n\n    if env is None:\n        env = Environment()\n\n    template = env.from_string(pattern)\n    return template.render(**params)\n</code></pre>"},{"location":"api/generate/#usage-example","title":"Usage Example","text":"<pre><code>from slurmkit import JobGenerator\n\n# Create generator from a job spec file\ngenerator = JobGenerator.from_spec(\"experiments/exp1/job_spec.yaml\")\n\n# Generate all job scripts\njobs = generator.generate()\n\nfor job in jobs:\n    print(f\"Generated: {job['script_path']}\")\n    print(f\"  Parameters: {job['params']}\")\n    print(f\"  Job name: {job['job_name']}\")\n</code></pre>"},{"location":"api/generate/#manual-configuration","title":"Manual Configuration","text":"<pre><code>from slurmkit.generate import JobGenerator, expand_grid\n\n# Expand parameter grid\nparams_list = expand_grid({\n    \"learning_rate\": [0.001, 0.01, 0.1],\n    \"batch_size\": [32, 64]\n})\n\n# Create generator manually\ngenerator = JobGenerator(\n    template_path=\"templates/train.job.j2\",\n    output_dir=\"jobs/exp1/job_scripts\",\n    parameters=params_list,\n    slurm_defaults={\"partition\": \"gpu\", \"time\": \"24:00:00\"},\n    job_name_pattern=\"lr{{ learning_rate }}_bs{{ batch_size }}\"\n)\n\n# Generate scripts\njobs = generator.generate()\n</code></pre>"},{"location":"api/slurm/","title":"SLURM Utilities","text":"<p>Functions for interacting with SLURM schedulers.</p>"},{"location":"api/slurm/#overview","title":"Overview","text":"<p>This module provides wrapper functions for common SLURM operations:</p> <ul> <li>Querying job status via <code>sacct</code> and <code>squeue</code></li> <li>Submitting jobs via <code>sbatch</code></li> <li>Finding job output files</li> <li>Parsing SLURM output formats</li> </ul>"},{"location":"api/slurm/#functions","title":"Functions","text":""},{"location":"api/slurm/#job-status","title":"Job Status","text":""},{"location":"api/slurm/#slurmkit.slurm.get_job_status","title":"get_job_status","text":"<pre><code>get_job_status(job_ids: Union[str, List[str]]) -&gt; Dict[str, str]\n</code></pre> <p>Get the state of one or more jobs.</p> <p>Convenience wrapper around get_sacct_info that returns only job states.</p> <p>Parameters:</p> Name Type Description Default <code>job_ids</code> <code>Union[str, List[str]]</code> <p>Single job ID or list of job IDs.</p> required <p>Returns:</p> Type Description <code>Dict[str, str]</code> <p>Dictionary mapping JobID to State string.</p> Example <p>get_job_status([\"12345\", \"12346\"])</p> Source code in <code>src/slurmkit/slurm.py</code> <pre><code>def get_job_status(job_ids: Union[str, List[str]]) -&gt; Dict[str, str]:\n    \"\"\"\n    Get the state of one or more jobs.\n\n    Convenience wrapper around get_sacct_info that returns only job states.\n\n    Args:\n        job_ids: Single job ID or list of job IDs.\n\n    Returns:\n        Dictionary mapping JobID to State string.\n\n    Example:\n        &gt;&gt;&gt; get_job_status([\"12345\", \"12346\"])\n        {'12345': 'COMPLETED', '12346': 'FAILED'}\n    \"\"\"\n    info = get_sacct_info(job_ids, fields=[\"JobID\", \"State\"])\n    return {jid: data.get(\"State\", \"UNKNOWN\") for jid, data in info.items()}\n</code></pre>"},{"location":"api/slurm/#slurmkit.slurm.get_sacct_info","title":"get_sacct_info","text":"<pre><code>get_sacct_info(job_ids: Union[str, List[str]], fields: Optional[List[str]] = None) -&gt; Dict[str, Dict[str, str]]\n</code></pre> <p>Query sacct for job metadata.</p> <p>Queries the SLURM accounting database for information about completed or running jobs. Results are filtered to exclude job steps (e.g., .batch, .extern) and only return the main job entry.</p> <p>Parameters:</p> Name Type Description Default <code>job_ids</code> <code>Union[str, List[str]]</code> <p>Single job ID or list of job IDs to query.</p> required <code>fields</code> <code>Optional[List[str]]</code> <p>List of sacct fields to retrieve. Defaults to DEFAULT_SACCT_FIELDS. Common fields: State, Elapsed, Start, End, ExitCode, AllocCPUS, ReqMem, NodeList, Partition. Run <code>sacct --helpformat</code> for full list.</p> <code>None</code> <p>Returns:</p> Type Description <code>Dict[str, Dict[str, str]]</code> <p>Dictionary mapping JobID to a dict of field values.</p> <code>Dict[str, Dict[str, str]]</code> <p>Returns empty dict if sacct is not available or no jobs found.</p> Example <p>info = get_sacct_info([\"12345\", \"12346\"]) info[\"12345\"][\"State\"] 'COMPLETED' info[\"12345\"][\"Elapsed\"] '01:23:45'</p> Source code in <code>src/slurmkit/slurm.py</code> <pre><code>def get_sacct_info(\n    job_ids: Union[str, List[str]],\n    fields: Optional[List[str]] = None,\n) -&gt; Dict[str, Dict[str, str]]:\n    \"\"\"\n    Query sacct for job metadata.\n\n    Queries the SLURM accounting database for information about completed\n    or running jobs. Results are filtered to exclude job steps (e.g., .batch,\n    .extern) and only return the main job entry.\n\n    Args:\n        job_ids: Single job ID or list of job IDs to query.\n        fields: List of sacct fields to retrieve. Defaults to DEFAULT_SACCT_FIELDS.\n            Common fields: State, Elapsed, Start, End, ExitCode, AllocCPUS,\n            ReqMem, NodeList, Partition. Run `sacct --helpformat` for full list.\n\n    Returns:\n        Dictionary mapping JobID to a dict of field values.\n        Returns empty dict if sacct is not available or no jobs found.\n\n    Example:\n        &gt;&gt;&gt; info = get_sacct_info([\"12345\", \"12346\"])\n        &gt;&gt;&gt; info[\"12345\"][\"State\"]\n        'COMPLETED'\n        &gt;&gt;&gt; info[\"12345\"][\"Elapsed\"]\n        '01:23:45'\n    \"\"\"\n    # Normalize to list\n    if isinstance(job_ids, str):\n        job_ids = [job_ids]\n\n    if not job_ids:\n        return {}\n\n    if fields is None:\n        fields = DEFAULT_SACCT_FIELDS.copy()\n\n    # Ensure JobID is always first\n    if \"JobID\" not in fields:\n        fields = [\"JobID\"] + list(fields)\n\n    # Build sacct command\n    # --parsable2 gives pipe-delimited output without trailing delimiter\n    cmd = [\n        \"sacct\",\n        \"-j\", \",\".join(job_ids),\n        f\"--format={','.join(fields)}\",\n        \"--parsable2\",\n        \"--noheader\",\n    ]\n\n    try:\n        result = run_command(cmd)\n        info_map = {}\n\n        for line in result.stdout.splitlines():\n            if not line.strip():\n                continue\n\n            parts = line.strip().split(\"|\")\n            if len(parts) &lt; len(fields):\n                continue\n\n            job_id_raw = parts[0]\n\n            # Filter out job steps (e.g., 12345.batch, 12345.extern)\n            # We only want the main job entry which has no dots\n            # (array jobs use underscore: 12345_1, 12345_2, etc.)\n            if \".\" not in job_id_raw:\n                info_map[job_id_raw] = {\n                    field: parts[i] for i, field in enumerate(fields)\n                }\n\n        return info_map\n\n    except FileNotFoundError:\n        print(\"Error: sacct command not found. Is SLURM installed?\", file=sys.stderr)\n        return {}\n</code></pre>"},{"location":"api/slurm/#slurmkit.slurm.get_pending_jobs","title":"get_pending_jobs","text":"<pre><code>get_pending_jobs(user: Optional[str] = None) -&gt; List[Dict[str, str]]\n</code></pre> <p>Query squeue for currently pending or running jobs.</p> <p>Parameters:</p> Name Type Description Default <code>user</code> <code>Optional[str]</code> <p>Username to filter jobs. If None, uses current user (--me).</p> <code>None</code> <p>Returns:</p> Type Description <code>List[Dict[str, str]]</code> <p>List of dicts with keys: 'job_id', 'job_name', 'state', 'wait_time'.</p> <code>List[Dict[str, str]]</code> <p>wait_time is formatted as human-readable string for pending jobs.</p> Example <p>pending = get_pending_jobs() pending[0]</p> Source code in <code>src/slurmkit/slurm.py</code> <pre><code>def get_pending_jobs(user: Optional[str] = None) -&gt; List[Dict[str, str]]:\n    \"\"\"\n    Query squeue for currently pending or running jobs.\n\n    Args:\n        user: Username to filter jobs. If None, uses current user (--me).\n\n    Returns:\n        List of dicts with keys: 'job_id', 'job_name', 'state', 'wait_time'.\n        wait_time is formatted as human-readable string for pending jobs.\n\n    Example:\n        &gt;&gt;&gt; pending = get_pending_jobs()\n        &gt;&gt;&gt; pending[0]\n        {'job_id': '12345', 'job_name': 'train_model', 'state': 'PENDING', 'wait_time': '2h 30m'}\n    \"\"\"\n    # Build squeue command\n    # --start shows estimated start time for pending jobs\n    # Format: job_id|job_name|state|start_time\n    cmd = [\"squeue\", \"--start\", \"--format=%i|%j|%T|%S\", \"--noheader\"]\n\n    if user:\n        cmd.extend([\"-u\", user])\n    else:\n        cmd.append(\"--me\")\n\n    try:\n        result = run_command(cmd)\n        pending_jobs = []\n        now = datetime.now()\n\n        for line in result.stdout.splitlines():\n            if not line.strip():\n                continue\n\n            parts = line.strip().split(\"|\")\n            if len(parts) &lt; 4:\n                continue\n\n            job_id, job_name, state, start_time_str = parts[:4]\n\n            job_info = {\n                \"job_id\": job_id,\n                \"job_name\": job_name,\n                \"state\": state,\n            }\n\n            # Calculate wait time for pending jobs\n            if state == \"PENDING\" and start_time_str not in (\"N/A\", \"Unknown\"):\n                wait_time = _parse_wait_time(start_time_str, now)\n                job_info[\"wait_time\"] = wait_time\n            elif state == \"PENDING\":\n                job_info[\"wait_time\"] = \"N/A\"\n\n            pending_jobs.append(job_info)\n\n        return pending_jobs\n\n    except FileNotFoundError:\n        print(\"Error: squeue command not found. Is SLURM installed?\", file=sys.stderr)\n        return []\n</code></pre>"},{"location":"api/slurm/#job-submission","title":"Job Submission","text":""},{"location":"api/slurm/#slurmkit.slurm.submit_job","title":"submit_job","text":"<pre><code>submit_job(script_path: Union[str, Path], dry_run: bool = False, extra_args: Optional[List[str]] = None) -&gt; Tuple[bool, Optional[str], str]\n</code></pre> <p>Submit a job script using sbatch.</p> <p>Parameters:</p> Name Type Description Default <code>script_path</code> <code>Union[str, Path]</code> <p>Path to the job script.</p> required <code>dry_run</code> <code>bool</code> <p>If True, print command without executing.</p> <code>False</code> <code>extra_args</code> <code>Optional[List[str]]</code> <p>Additional arguments to pass to sbatch.</p> <code>None</code> <p>Returns:</p> Type Description <code>bool</code> <p>Tuple of (success, job_id, message).</p> <code>Optional[str]</code> <ul> <li>success: True if submission succeeded.</li> </ul> <code>str</code> <ul> <li>job_id: The submitted job ID (None if failed or dry_run).</li> </ul> <code>Tuple[bool, Optional[str], str]</code> <ul> <li>message: Output message from sbatch or error message.</li> </ul> Example <p>success, job_id, msg = submit_job(\"jobs/train.job\") print(f\"Submitted job {job_id}\") Submitted job 12345</p> Source code in <code>src/slurmkit/slurm.py</code> <pre><code>def submit_job(\n    script_path: Union[str, Path],\n    dry_run: bool = False,\n    extra_args: Optional[List[str]] = None,\n) -&gt; Tuple[bool, Optional[str], str]:\n    \"\"\"\n    Submit a job script using sbatch.\n\n    Args:\n        script_path: Path to the job script.\n        dry_run: If True, print command without executing.\n        extra_args: Additional arguments to pass to sbatch.\n\n    Returns:\n        Tuple of (success, job_id, message).\n        - success: True if submission succeeded.\n        - job_id: The submitted job ID (None if failed or dry_run).\n        - message: Output message from sbatch or error message.\n\n    Example:\n        &gt;&gt;&gt; success, job_id, msg = submit_job(\"jobs/train.job\")\n        &gt;&gt;&gt; print(f\"Submitted job {job_id}\")\n        Submitted job 12345\n    \"\"\"\n    script_path = Path(script_path)\n\n    if not script_path.exists():\n        return False, None, f\"Script not found: {script_path}\"\n\n    cmd = [\"sbatch\"]\n    if extra_args:\n        cmd.extend(extra_args)\n    cmd.append(str(script_path))\n\n    if dry_run:\n        return True, None, f\"[dry-run] {' '.join(cmd)}\"\n\n    try:\n        result = run_command(cmd)\n\n        if result.returncode == 0:\n            # Parse job ID from sbatch output\n            # Typical output: \"Submitted batch job 12345\"\n            output = result.stdout.strip()\n            job_id = None\n\n            match = re.search(r\"Submitted batch job (\\d+)\", output)\n            if match:\n                job_id = match.group(1)\n\n            return True, job_id, output\n\n        else:\n            error_msg = result.stderr.strip() or result.stdout.strip()\n            return False, None, f\"sbatch failed: {error_msg}\"\n\n    except FileNotFoundError:\n        return False, None, \"sbatch command not found. Is SLURM installed?\"\n</code></pre>"},{"location":"api/slurm/#job-output","title":"Job Output","text":""},{"location":"api/slurm/#slurmkit.slurm.find_job_output","title":"find_job_output","text":"<pre><code>find_job_output(job_id: str, jobs_dir: Optional[Path] = None, config: Optional[Config] = None) -&gt; List[Path]\n</code></pre> <p>Find job output files matching a job ID.</p> <p>Searches for .out files containing the job ID in their filename, using configured output patterns to match files.</p> <p>Parameters:</p> Name Type Description Default <code>job_id</code> <code>str</code> <p>SLURM job ID to search for.</p> required <code>jobs_dir</code> <code>Optional[Path]</code> <p>Directory to search in. If None, uses config's jobs_dir.</p> <code>None</code> <code>config</code> <code>Optional[Config]</code> <p>Configuration object. If None, uses global config.</p> <code>None</code> <p>Returns:</p> Type Description <code>List[Path]</code> <p>List of matching file paths, sorted by modification time (newest first).</p> Example <p>outputs = find_job_output(\"12345\") outputs[0] PosixPath('jobs/exp1/logs/train_model.12345.out')</p> Source code in <code>src/slurmkit/slurm.py</code> <pre><code>def find_job_output(\n    job_id: str,\n    jobs_dir: Optional[Path] = None,\n    config: Optional[Config] = None,\n) -&gt; List[Path]:\n    \"\"\"\n    Find job output files matching a job ID.\n\n    Searches for .out files containing the job ID in their filename,\n    using configured output patterns to match files.\n\n    Args:\n        job_id: SLURM job ID to search for.\n        jobs_dir: Directory to search in. If None, uses config's jobs_dir.\n        config: Configuration object. If None, uses global config.\n\n    Returns:\n        List of matching file paths, sorted by modification time (newest first).\n\n    Example:\n        &gt;&gt;&gt; outputs = find_job_output(\"12345\")\n        &gt;&gt;&gt; outputs[0]\n        PosixPath('jobs/exp1/logs/train_model.12345.out')\n    \"\"\"\n    if config is None:\n        config = get_config()\n\n    if jobs_dir is None:\n        jobs_dir = config.get_path(\"jobs_dir\")\n\n    if jobs_dir is None or not jobs_dir.exists():\n        return []\n\n    # Search for files containing the job ID\n    # Use glob pattern that matches the ID anywhere in the filename\n    pattern = f\"**/*{job_id}*.out\"\n    matches = list(jobs_dir.glob(pattern))\n\n    # Sort by modification time (newest first)\n    matches.sort(key=lambda p: p.stat().st_mtime, reverse=True)\n\n    return matches\n</code></pre>"},{"location":"api/slurm/#slurmkit.slurm.get_job_script_path","title":"get_job_script_path","text":"<pre><code>get_job_script_path(job_id: str) -&gt; Optional[Path]\n</code></pre> <p>Get the script path for a job using scontrol.</p> <p>This only works for jobs that are still in SLURM's active job table (typically running or recently completed jobs).</p> <p>Parameters:</p> Name Type Description Default <code>job_id</code> <code>str</code> <p>SLURM job ID.</p> required <p>Returns:</p> Type Description <code>Optional[Path]</code> <p>Path to the job script, or None if not found.</p> Source code in <code>src/slurmkit/slurm.py</code> <pre><code>def get_job_script_path(job_id: str) -&gt; Optional[Path]:\n    \"\"\"\n    Get the script path for a job using scontrol.\n\n    This only works for jobs that are still in SLURM's active job table\n    (typically running or recently completed jobs).\n\n    Args:\n        job_id: SLURM job ID.\n\n    Returns:\n        Path to the job script, or None if not found.\n    \"\"\"\n    cmd = [\"scontrol\", \"show\", \"job\", job_id]\n\n    try:\n        result = run_command(cmd)\n        if result.returncode != 0 or not result.stdout.strip():\n            return None\n\n        # Parse key=value output\n        for token in result.stdout.split():\n            if \"=\" not in token:\n                continue\n            key, value = token.split(\"=\", 1)\n            if key in (\"Command\", \"BatchScript\"):\n                if value and value not in (\"(null)\", \"Unknown\"):\n                    return Path(value)\n\n        return None\n\n    except FileNotFoundError:\n        return None\n</code></pre>"},{"location":"api/slurm/#usage-example","title":"Usage Example","text":"<pre><code>from slurmkit import (\n    get_job_status,\n    get_sacct_info,\n    get_pending_jobs,\n    submit_job,\n    find_job_output,\n)\n\n# Get status of specific jobs\nstatuses = get_job_status([\"12345\", \"12346\", \"12347\"])\nfor job_id, status in statuses.items():\n    print(f\"Job {job_id}: {status}\")\n\n# Get detailed accounting info\ninfo = get_sacct_info([\"12345\"])\nprint(info)  # DataFrame with job details\n\n# List pending/running jobs\npending = get_pending_jobs()\nprint(f\"You have {len(pending)} jobs in the queue\")\n\n# Submit a job script\njob_id = submit_job(\"jobs/exp1/job_scripts/train.sh\")\nprint(f\"Submitted job: {job_id}\")\n\n# Find output file for a job\noutput_path = find_job_output(\n    job_id=\"12345\",\n    job_name=\"lr0.01_bs32\",\n    search_dirs=[\"jobs/exp1/logs\"]\n)\nprint(f\"Output file: {output_path}\")\n</code></pre>"},{"location":"api/sync/","title":"Sync","text":"<p>Cross-cluster job state synchronization.</p>"},{"location":"api/sync/#overview","title":"Overview","text":"<p>The <code>SyncManager</code> class enables sharing job states across multiple compute clusters via git. This is useful when:</p> <ul> <li>Running experiments across multiple clusters</li> <li>Sharing job status with collaborators</li> <li>Maintaining a central record of all job states</li> </ul>"},{"location":"api/sync/#classes","title":"Classes","text":""},{"location":"api/sync/#syncmanager","title":"SyncManager","text":""},{"location":"api/sync/#slurmkit.sync.SyncManager","title":"SyncManager","text":"<pre><code>SyncManager(sync_dir: Optional[Union[str, Path]] = None, config: Optional[Config] = None)\n</code></pre> <p>Manager for cross-cluster job state synchronization.</p> <p>Handles writing sync files and optionally committing/pushing them to git for sharing across clusters.</p> <p>Attributes:</p> Name Type Description <code>sync_dir</code> <p>Directory where sync files are stored.</p> <code>hostname</code> <p>Current machine's hostname.</p> Example <p>sync_mgr = SyncManager() sync_mgr.sync_all()  # Refresh and write sync file sync_mgr.push()      # Git commit and push</p> <p>Initialize the sync manager.</p> <p>Parameters:</p> Name Type Description Default <code>sync_dir</code> <code>Optional[Union[str, Path]]</code> <p>Directory for sync files. If None, uses config.</p> <code>None</code> <code>config</code> <code>Optional[Config]</code> <p>Configuration object. If None, uses global config.</p> <code>None</code> Source code in <code>src/slurmkit/sync.py</code> <pre><code>def __init__(\n    self,\n    sync_dir: Optional[Union[str, Path]] = None,\n    config: Optional[Config] = None,\n):\n    \"\"\"\n    Initialize the sync manager.\n\n    Args:\n        sync_dir: Directory for sync files. If None, uses config.\n        config: Configuration object. If None, uses global config.\n    \"\"\"\n    if config is None:\n        config = get_config()\n\n    self.config = config\n    self.hostname = socket.gethostname()\n\n    if sync_dir is not None:\n        self.sync_dir = Path(sync_dir)\n    else:\n        self.sync_dir = config.get_path(\"sync_dir\")\n        if self.sync_dir is None:\n            self.sync_dir = Path(\".slurm-kit/sync\")\n\n    self._collection_manager = CollectionManager(config=config)\n</code></pre>"},{"location":"api/sync/#slurmkit.sync.SyncManager.sync_collection","title":"sync_collection","text":"<pre><code>sync_collection(name: str) -&gt; Dict[str, Any]\n</code></pre> <p>Sync a single collection's job states.</p> <p>Refreshes job states from SLURM and returns the updated data.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Collection name.</p> required <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Collection sync data dictionary.</p> Source code in <code>src/slurmkit/sync.py</code> <pre><code>def sync_collection(self, name: str) -&gt; Dict[str, Any]:\n    \"\"\"\n    Sync a single collection's job states.\n\n    Refreshes job states from SLURM and returns the updated data.\n\n    Args:\n        name: Collection name.\n\n    Returns:\n        Collection sync data dictionary.\n    \"\"\"\n    collection = self._collection_manager.load(name)\n\n    # Refresh states from SLURM\n    updated_count = collection.refresh_states()\n\n    # Save updated collection\n    self._collection_manager.save(collection)\n\n    # Build sync data\n    summary = collection.get_summary()\n\n    jobs_data = []\n    for job in collection.jobs:\n        job_data = {\n            \"job_name\": job[\"job_name\"],\n            \"job_id\": job.get(\"job_id\"),\n            \"state\": job.get(\"state\"),\n            \"hostname\": job.get(\"hostname\"),\n        }\n\n        # Include resubmission info if any\n        if job.get(\"resubmissions\"):\n            job_data[\"resubmissions\"] = [\n                {\n                    \"job_id\": r.get(\"job_id\"),\n                    \"state\": r.get(\"state\"),\n                    \"hostname\": r.get(\"hostname\"),\n                }\n                for r in job[\"resubmissions\"]\n            ]\n\n        jobs_data.append(job_data)\n\n    return {\n        \"name\": name,\n        \"description\": collection.description,\n        \"updated_jobs\": updated_count,\n        **summary,\n        \"jobs\": jobs_data,\n    }\n</code></pre>"},{"location":"api/sync/#slurmkit.sync.SyncManager.sync_all","title":"sync_all","text":"<pre><code>sync_all(collection_names: Optional[List[str]] = None) -&gt; Dict[str, Any]\n</code></pre> <p>Sync all collections and write sync file.</p> <p>Parameters:</p> Name Type Description Default <code>collection_names</code> <code>Optional[List[str]]</code> <p>List of collection names to sync. If None, syncs all collections.</p> <code>None</code> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Complete sync data dictionary.</p> Source code in <code>src/slurmkit/sync.py</code> <pre><code>def sync_all(\n    self,\n    collection_names: Optional[List[str]] = None,\n) -&gt; Dict[str, Any]:\n    \"\"\"\n    Sync all collections and write sync file.\n\n    Args:\n        collection_names: List of collection names to sync.\n            If None, syncs all collections.\n\n    Returns:\n        Complete sync data dictionary.\n    \"\"\"\n    if collection_names is None:\n        collection_names = self._collection_manager.list_collections()\n\n    collections_data = {}\n    total_updated = 0\n\n    for name in collection_names:\n        try:\n            data = self.sync_collection(name)\n            collections_data[name] = data\n            total_updated += data.get(\"updated_jobs\", 0)\n        except FileNotFoundError:\n            # Skip collections that don't exist\n            continue\n        except Exception as e:\n            # Log error but continue with other collections\n            print(f\"Warning: Error syncing collection '{name}': {e}\")\n            continue\n\n    # Build sync file data\n    sync_data = {\n        \"cluster\": self.hostname,\n        \"synced_at\": datetime.now().isoformat(timespec=\"seconds\"),\n        \"total_collections\": len(collections_data),\n        \"total_jobs_updated\": total_updated,\n        \"collections\": collections_data,\n    }\n\n    # Write sync file\n    self._ensure_dir()\n    sync_path = self.get_sync_file_path()\n\n    with open(sync_path, \"w\") as f:\n        yaml.dump(\n            sync_data,\n            f,\n            default_flow_style=False,\n            sort_keys=False,\n            allow_unicode=True,\n        )\n\n    return sync_data\n</code></pre>"},{"location":"api/sync/#slurmkit.sync.SyncManager.push","title":"push","text":"<pre><code>push(message: Optional[str] = None) -&gt; bool\n</code></pre> <p>Git commit and push sync files.</p> <p>Parameters:</p> Name Type Description Default <code>message</code> <code>Optional[str]</code> <p>Commit message. If None, uses a default message.</p> <code>None</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>src/slurmkit/sync.py</code> <pre><code>def push(self, message: Optional[str] = None) -&gt; bool:\n    \"\"\"\n    Git commit and push sync files.\n\n    Args:\n        message: Commit message. If None, uses a default message.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"\n    sync_path = self.get_sync_file_path()\n\n    if not sync_path.exists():\n        print(\"No sync file to push. Run sync first.\")\n        return False\n\n    if message is None:\n        message = f\"slurmkit sync: {self.hostname} at {datetime.now().isoformat(timespec='seconds')}\"\n\n    try:\n        # Git add\n        result = subprocess.run(\n            [\"git\", \"add\", str(sync_path)],\n            capture_output=True,\n            text=True,\n            cwd=self.sync_dir.parent,\n        )\n        if result.returncode != 0:\n            print(f\"git add failed: {result.stderr}\")\n            return False\n\n        # Git commit\n        result = subprocess.run(\n            [\"git\", \"commit\", \"-m\", message],\n            capture_output=True,\n            text=True,\n            cwd=self.sync_dir.parent,\n        )\n        if result.returncode != 0:\n            if \"nothing to commit\" in result.stdout:\n                print(\"No changes to commit.\")\n                return True\n            print(f\"git commit failed: {result.stderr}\")\n            return False\n\n        # Git push\n        result = subprocess.run(\n            [\"git\", \"push\"],\n            capture_output=True,\n            text=True,\n            cwd=self.sync_dir.parent,\n        )\n        if result.returncode != 0:\n            print(f\"git push failed: {result.stderr}\")\n            return False\n\n        print(f\"Successfully pushed sync file: {sync_path.name}\")\n        return True\n\n    except FileNotFoundError:\n        print(\"git command not found.\")\n        return False\n</code></pre>"},{"location":"api/sync/#slurmkit.sync.SyncManager.get_sync_file_path","title":"get_sync_file_path","text":"<pre><code>get_sync_file_path(hostname: Optional[str] = None) -&gt; Path\n</code></pre> <p>Get the path to a sync file for a hostname.</p> <p>Parameters:</p> Name Type Description Default <code>hostname</code> <code>Optional[str]</code> <p>Hostname for the sync file. Defaults to current host.</p> <code>None</code> <p>Returns:</p> Type Description <code>Path</code> <p>Path to the sync file.</p> Source code in <code>src/slurmkit/sync.py</code> <pre><code>def get_sync_file_path(self, hostname: Optional[str] = None) -&gt; Path:\n    \"\"\"\n    Get the path to a sync file for a hostname.\n\n    Args:\n        hostname: Hostname for the sync file. Defaults to current host.\n\n    Returns:\n        Path to the sync file.\n    \"\"\"\n    hostname = hostname or self.hostname\n    return self.sync_dir / f\"{hostname}.yaml\"\n</code></pre>"},{"location":"api/sync/#usage-example","title":"Usage Example","text":"<pre><code>from slurmkit.sync import SyncManager\nfrom slurmkit import CollectionManager\n\n# Initialize sync manager\nsync = SyncManager()\n\n# Get a collection\nmanager = CollectionManager()\ncollection = manager.get(\"my_experiment\")\n\n# Sync collection state to git-tracked file\nsync.sync_collection(collection)\n\n# Push changes to remote\nsync.push(message=\"Update job states from cluster-a\")\n</code></pre>"},{"location":"api/sync/#cli-usage","title":"CLI Usage","text":"<p>The sync functionality is typically used via the CLI:</p> <pre><code># Sync all collections and push\nslurmkit sync --push\n\n# Sync specific collection\nslurmkit sync --collection my_experiment\n\n# On another cluster, pull and view\ngit pull\nslurmkit collection show my_experiment\n</code></pre>"}]}